<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<title>Profile — FAOA</title>
<style>
:root{
  --ink:#eef3ff; --ink-dim:#cfd3e1; --muted:rgba(238,243,255,.78);
  --bg:#000; --panel:#0b0d12; --stroke:rgba(255,255,255,.18);
  --blue:#0A84FF; --gold:#ffd700; --silver:#c0c7d1; --bronze:#b87333;
  --support:#6a4cff; --director:#444; --danger:#ff3b30;
  --r:14px; --gap:12px; --btn-h:44px;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:var(--bg);color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif}
a{color:inherit;text-decoration:none}

/* Page wrap */
.wrap{max-width:820px;margin:0 auto;padding:12px 14px 24px}

/* Top bar */
.top{position:sticky;top:0;z-index:2;display:flex;align-items:center;gap:8px;
  padding:10px 6px 12px;background:linear-gradient(180deg,rgba(0,0,0,.9),rgba(0,0,0,.55) 60%,rgba(0,0,0,0));
  -webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}
.back{height:36px;min-width:36px;border-radius:12px;border:1px solid var(--stroke);background:#101218;color:#fff;font-weight:900;cursor:pointer}
.title{margin:0;font-size:20px;font-weight:900}

/* Avatar banner (text pill, no photo) */
.banner{margin:8px 0 14px;padding:14px;border:1px solid var(--stroke);border-radius:16px;background:var(--panel);display:flex;align-items:center;justify-content:space-between;gap:12px}
.pill{display:flex;flex-direction:column;gap:2px;padding:10px 14px;border-radius:12px;border:1px solid var(--stroke);min-width:160px}
.pill .name{font-size:16px;font-weight:900}
.pill .lvl{font-size:12px;opacity:.95}

/* Level control */
.level-box{display:flex;align-items:center;gap:10px}
.level{appearance:none;-webkit-appearance:none;background:#0f1218;border:1px solid var(--stroke);color:var(--ink);
  border-radius:10px;height:36px;padding:0 12px;font-weight:800;cursor:pointer}

/* Sections (collapsible-friendly styling if you add more later) */
.card{border:1px solid var(--stroke);border-radius:16px;background:var(--panel);padding:14px;margin:12px 0}
.row{display:grid;grid-template-columns:140px 1fr;gap:12px;align-items:center;margin:10px 0}
.label{color:var(--ink-dim);font-weight:700}
.input{height:40px;border-radius:10px;border:1px solid var(--stroke);background:#0f1218;color:var(--ink);padding:0 12px;font:inherit}
.input[readonly]{opacity:.8}

/* Actions */
.actions{display:flex;gap:10px;justify-content:space-between;margin-top:16px}
.btn{display:inline-flex;align-items:center;justify-content:center;height:var(--btn-h);padding:0 16px;border-radius:12px;border:1px solid var(--stroke);
  font-weight:900;background:#0f1116;color:var(--ink);cursor:pointer}
.btn.blue{background:var(--blue);border-color:transparent;color:#000}
.btn.ghost{background:#14161c}
.btn.danger{background:var(--danger);border-color:transparent}

/* Role colors applied to pill */
.role-admin{background:var(--blue);color:#0b0c10}
.role-director{background:var(--director);color:#fff}
.role-support{background:var(--support);color:#fff}
.role-gold{background:var(--gold);color:#0b0c10}
.role-silver{background:var(--silver);color:#0b0c10}
.role-bronze{background:var(--bronze);color:#fff}

/* Helper */
.small{font-size:12px;color:var(--ink-dim)}
</style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <button class="back" id="btnBack" aria-label="Back">‹</button>
    <h1 class="title">Profile</h1>
  </div>

  <!-- Avatar text pill + Level selector -->
  <section class="banner">
    <div class="pill" id="pill">
      <div class="name" id="pillName">User</div>
      <div class="lvl" id="pillLvl">Admin</div>
    </div>
    <div class="level-box">
      <label for="level" class="label">Level</label>
      <select id="level" class="level" aria-label="User level">
        <option value="admin">Admin</option>
        <option value="director">Director</option>
        <option value="support">Support</option>
        <option value="gold">Gold</option>
        <option value="silver">Silver</option>
        <option value="bronze">Bronze</option>
      </select>
    </div>
  </section>

  <!-- Basic details (kept minimal; you can expand later) -->
  <section class="card">
    <div class="row">
      <div class="label">First name</div>
      <input id="firstName" class="input" type="text" autocomplete="given-name" />
    </div>
    <div class="row">
      <div class="label">Surname</div>
      <input id="lastName" class="input" type="text" autocomplete="family-name" />
    </div>
    <div class="row">
      <div class="label">Display name</div>
      <input id="displayName" class="input" type="text" autocomplete="nickname" />
    </div>
    <div class="row">
      <div class="label">Email</div>
      <input id="email" class="input" type="email" autocomplete="email" />
    </div>
    <div class="row">
      <div class="label">Username</div>
      <input id="username" class="input" type="text" readonly />
    </div>
    <div class="row">
      <div class="label">Password</div>
      <button id="btnChangePw" class="btn ghost" type="button">Change Password</button>
    </div>
    <div class="small">Password change flow to be implemented later.</div>
  </section>

  <div class="actions">
    <button class="btn ghost" id="btnCancel" type="button">Cancel</button>
    <button class="btn blue" id="btnSave" type="button">Save</button>
  </div>
</div>

<script>
(()=>{'use strict';
/* Storage helpers (shared with Home) */
const store={get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
             set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};
const K={ profile:'ao_profile' };

/* Elements */
const pill=document.getElementById('pill');
const pillName=document.getElementById('pillName');
const pillLvl=document.getElementById('pillLvl');
const levelSel=document.getElementById('level');
const first=document.getElementById('firstName');
const last=document.getElementById('lastName');
const displayName=document.getElementById('displayName');
const email=document.getElementById('email');
const username=document.getElementById('username');

/* Role → pill class */
const ROLE_CLASS={
  admin:'role-admin',
  director:'role-director',
  support:'role-support',
  gold:'role-gold',
  silver:'role-silver',
  bronze:'role-bronze'
};

/* Load into form */
let original = store.get(K.profile,{
  firstName:'', lastName:'', displayName:'User', email:'', username:'user',
  skill:'admin'
});
function paintFrom(p){
  // pill
  const role=(p.skill||'silver').toLowerCase();
  pill.className='pill ' + (ROLE_CLASS[role]||ROLE_CLASS.silver);
  pillName.textContent = p.displayName || 'User';
  pillLvl.textContent = role.charAt(0).toUpperCase()+role.slice(1);

  // form
  levelSel.value = role;
  first.value = p.firstName || '';
  last.value = p.lastName || '';
  displayName.value = p.displayName || '';
  email.value = p.email || '';
  username.value = p.username || 'user';
}
paintFrom(original);

/* Update pill live when level or display name changes */
levelSel.addEventListener('change',()=>{
  const role=levelSel.value;
  pill.className='pill ' + (ROLE_CLASS[role]||ROLE_CLASS.silver);
  pillLvl.textContent= role.charAt(0).toUpperCase()+role.slice(1);
});
displayName.addEventListener('input',()=>{ pillName.textContent=displayName.value||'User'; });

/* Save / Cancel / Back */
function gather(){
  return {
    firstName:first.value.trim(),
    lastName:last.value.trim(),
    displayName:displayName.value.trim()||'User',
    email:email.value.trim(),
    username:username.value.trim()||'user',
    skill:levelSel.value  // <- this is what Home reads to set role/skin/admin controls
  };
}
function save(){
  const next=gather();
  store.set(K.profile,next);
  // Notify opener so Home can repaint immediately
  try{ window.parent && window.parent.dispatchEvent(new StorageEvent('storage',{key:K.profile})); }catch{}
  // Small haptic: change button text briefly
  const btn=document.getElementById('btnSave');
  const t=btn.textContent; btn.textContent='Saved ✓'; setTimeout(()=>btn.textContent=t,1000);
}
function cancel(){
  paintFrom(original);
}
document.getElementById('btnSave').addEventListener('click', save);
document.getElementById('btnCancel').addEventListener('click', cancel);
document.getElementById('btnBack').addEventListener('click', ()=>{ history.back(); });

/* Password placeholder */
document.getElementById('btnChangePw').addEventListener('click', ()=>{
  alert('Password change flow coming soon.');
});
})();
</script>
</body>
</html>