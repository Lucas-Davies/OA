<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="dark">
<title>Settings — FAOA</title>
<style>
:root{ --bg:#000; --panel:#0f1116; --panel2:#121318; --ink:#eef3ff; --ink-dim:#cfd3e1; --stroke:rgba(255,255,255,.18); --blue:#0A84FF }
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text"}
header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(0,0,0,.9),rgba(0,0,0,.65));-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);border-bottom:1px solid var(--stroke)}
.bar{display:flex;align-items:center;gap:8px;height:52px;padding:0 10px}
.back{width:36px;height:36px;border-radius:10px;border:1px solid var(--stroke);background:#15171f;color:#fff;font-weight:900;display:flex;align-items:center;justify-content:center;cursor:pointer}
.bar h1{margin:0;font:900 20px/1 -apple-system}
main{max-width:760px;margin:0 auto;padding:12px}
.card{background:var(--panel);border:1px solid var(--stroke);border-radius:14px;margin:12px 0;overflow:hidden}
.row{display:flex;align-items:center;justify-content:space-between;padding:14px 12px;border-bottom:1px solid rgba(255,255,255,.08)}
.row:last-child{border-bottom:none}
strong{font-weight:900}
.switch{position:relative;display:inline-block;width:52px;height:30px}
.switch input{display:none}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#2a2a2a;border-radius:999px;border:1px solid var(--stroke);transition:.2s}
.slider:before{content:"";position:absolute;height:24px;width:24px;left:3px;top:2px;background:white;border-radius:50%;transition:.2s}
input:checked + .slider{background:var(--blue)}
input:checked + .slider:before{transform:translateX(22px)}
.btn{display:inline-flex;align-items:center;justify-content:center;height:40px;padding:0 14px;border-radius:10px;border:1px solid var(--stroke);background:#181b22;color:#fff;font-weight:800;cursor:pointer}
.btn.blue{background:var(--blue);border-color:transparent;color:#000}
.chips{display:flex;gap:8px;flex-wrap:wrap;padding:12px}
.chips button{padding:8px 12px;border:1px dashed rgba(255,255,255,.18);border-radius:999px;background:#0b0c10;color:#fff;cursor:grab}
.groupTitle{font-weight:900;margin:14px 2px 6px}
fieldset{border:0;margin:0;padding:8px 12px}
label.checkbox{display:flex;align-items:center;gap:10px;margin:8px 0}
label.checkbox input{width:20px;height:20px}
footer.actions{display:flex;gap:10px;flex-wrap:wrap;margin:12px 2px}
small.note{color:var(--ink-dim);display:block;margin:8px 2px}
</style>
</head>
<body>
<header><div class="bar">
  <button class="back" id="backBtn">‹</button>
  <h1>Settings</h1>
</div></header>

<main>
  <!-- Display -->
  <div class="groupTitle">Display</div>
  <div class="card">
    <div class="row">
      <strong>Background</strong>
      <select id="bgSelect">
        <option value="photo1">Default Photo</option>
        <option value="plain">Plain Black</option>
      </select>
    </div>
    <div class="row">
      <strong>Theme</strong>
      <select id="themeSelect" disabled>
        <option value="dark">Dark</option>
      </select>
    </div>
  </div>

  <!-- Home Screen -->
  <div class="groupTitle">Home Screen</div>
  <div class="card">
    <div class="row"><strong>Show “Challenges”</strong><label class="switch"><input id="showChallenges" type="checkbox"><span class="slider"></span></label></div>
    <div class="row"><strong>Show “Courses”</strong><label class="switch"><input id="showCourses" type="checkbox"><span class="slider"></span></label></div>
    <div class="row"><strong>Show “Live”</strong><label class="switch"><input id="showLive" type="checkbox"><span class="slider"></span></label></div>
    <div class="row" style="justify-content:flex-start;gap:10px"><strong>Tab Order</strong></div>
    <div class="chips" id="orderChips"></div>
  </div>
  <small class="note">Drag chips to reorder tabs.</small>

  <!-- Challenges -->
  <div class="groupTitle">Challenges</div>
  <div class="card">
    <div class="row"><strong>Hide Daily</strong><label class="switch"><input id="hideDaily" type="checkbox"><span class="slider"></span></label></div>
    <div class="row"><strong>Hide Weekly</strong><label class="switch"><input id="hideWeekly" type="checkbox"><span class="slider"></span></label></div>
    <div class="row"><strong>Hide Tracker</strong>
      <select id="hideTracker">
        <option value="none">Show Both</option>
        <option value="daily">Hide Daily Tracker</option>
        <option value="weekly">Hide Weekly Tracker</option>
        <option value="both">Hide Both</option>
      </select>
    </div>
    <fieldset>
      <legend class="groupTitle" style="margin:0">Show Daily for Levels</legend>
      <label class="checkbox"><input type="checkbox" id="lvlMy"> My Level</label>
      <label class="checkbox"><input type="checkbox" id="lvlBeginner"> Beginner</label>
      <label class="checkbox"><input type="checkbox" id="lvlIntermediate"> Intermediate</label>
      <label class="checkbox"><input type="checkbox" id="lvlAdvanced"> Advanced</label>
      <label class="checkbox"><input type="checkbox" id="lvlExpert"> Expert</label>
    </fieldset>
  </div>

  <!-- Courses -->
  <div class="groupTitle">Courses</div>
  <div class="card">
    <div class="row"><strong>Hide Completed Courses</strong><label class="switch"><input id="hideCompleted" type="checkbox"><span class="slider"></span></label></div>
    <fieldset>
      <legend class="groupTitle" style="margin:0">Show Courses For Levels</legend>
      <label class="checkbox"><input type="checkbox" id="cMy"> My Level</label>
      <label class="checkbox"><input type="checkbox" id="cBeginner"> Beginner</label>
      <label class="checkbox"><input type="checkbox" id="cIntermediate"> Intermediate</label>
      <label class="checkbox"><input type="checkbox" id="cAdvanced"> Advanced</label>
      <label class="checkbox"><input type="checkbox" id="cExpert"> Expert</label>
    </fieldset>
  </div>

  <footer class="actions">
    <button class="btn blue" id="saveBtn" type="button">Save</button>
    <button class="btn" id="cancelBtn" type="button">Cancel</button>
  </footer>
</main>

<script>
(()=>{'use strict';
const KEY='ao_settings';
const $=s=>document.querySelector(s);
const store={ get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
              set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)) };
const defaults={
  display:{background:'photo1',theme:'dark'},
  home:{tabs:{challenges:true,courses:true,live:true},order:['challenges','courses','live']},
  challenges:{hideDaily:false,hideWeekly:false,hideTracker:'none',levels:['my']},
  courses:{hideCompleted:false,levels:['my']}
};

function back(){ if(history.length>1) history.back(); }
$('#backBtn').addEventListener('click', back);
$('#cancelBtn').addEventListener('click', back);

function load(){
  const s=Object.assign({},defaults, store.get(KEY,{}));
  // display
  $('#bgSelect').value=s.display?.background||'photo1';
  $('#themeSelect').value=s.display?.theme||'dark';
  // home toggles
  const vis=s.home?.tabs||defaults.home.tabs;
  $('#showChallenges').checked=vis.challenges!==false;
  $('#showCourses').checked=vis.courses!==false;
  $('#showLive').checked=vis.live!==false;
  // order chips
  const chips=$('#orderChips'); chips.innerHTML='';
  (s.home?.order && s.home.order.length ? s.home.order : defaults.home.order).forEach(t=>{
    const b=document.createElement('button'); b.textContent=t[0].toUpperCase()+t.slice(1); b.dataset.tab=t; b.draggable=true; chips.appendChild(b);
  });
  chips.addEventListener('dragstart',e=>{ if(e.target.tagName!=='BUTTON') return; e.dataTransfer.setData('text/plain',e.target.dataset.tab); });
  chips.addEventListener('dragover',e=>e.preventDefault());
  chips.addEventListener('drop',e=>{
    e.preventDefault();
    const from=e.dataTransfer.getData('text/plain');
    const target=e.target.closest('button'); if(!from||!target) return;
    const fromEl=[...chips.children].find(x=>x.dataset.tab===from);
    chips.insertBefore(fromEl, target);
  });

  // challenges
  $('#hideDaily').checked=!!s.challenges?.hideDaily;
  $('#hideWeekly').checked=!!s.challenges?.hideWeekly;
  $('#hideTracker').value=s.challenges?.hideTracker||'none';
  const L=s.challenges?.levels||['my'];
  $('#lvlMy').checked=L.includes('my'); $('#lvlBeginner').checked=L.includes('beginner');
  $('#lvlIntermediate').checked=L.includes('intermediate'); $('#lvlAdvanced').checked=L.includes('advanced'); $('#lvlExpert').checked=L.includes('expert');

  // courses
  $('#hideCompleted').checked=!!s.courses?.hideCompleted;
  const LC=s.courses?.levels||['my'];
  $('#cMy').checked=LC.includes('my'); $('#cBeginner').checked=LC.includes('beginner');
  $('#cIntermediate').checked=LC.includes('intermediate'); $('#cAdvanced').checked=LC.includes('advanced'); $('#cExpert').checked=LC.includes('expert');
}
load();

$('#saveBtn').addEventListener('click', ()=>{
  const order=[...document.querySelectorAll('#orderChips button')].map(b=>b.dataset.tab);
  const s={
    display:{ background: $('#bgSelect').value, theme: $('#themeSelect').value },
    home:{ tabs:{challenges:$('#showChallenges').checked, courses:$('#showCourses').checked, live:$('#showLive').checked}, order },
    challenges:{
      hideDaily: $('#hideDaily').checked,
      hideWeekly: $('#hideWeekly').checked,
      hideTracker: $('#hideTracker').value,
      levels: [
        $('#lvlMy').checked?'my':null,
        $('#lvlBeginner').checked?'beginner':null,
        $('#lvlIntermediate').checked?'intermediate':null,
        $('#lvlAdvanced').checked?'advanced':null,
        $('#lvlExpert').checked?'expert':null
      ].filter(Boolean)
    },
    courses:{
      hideCompleted: $('#hideCompleted').checked,
      levels: [
        $('#cMy').checked?'my':null,
        $('#cBeginner').checked?'beginner':null,
        $('#cIntermediate').checked?'intermediate':null,
        $('#cAdvanced').checked?'advanced':null,
        $('#cExpert').checked?'expert':null
      ].filter(Boolean)
    }
  };
  store.set(KEY,s);
  alert('Saved');
});
})();
</script>
</body>
</html>