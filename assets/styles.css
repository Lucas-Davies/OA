:root{
  --ink:#eef3ff;
  --muted:rgba(238,243,255,.75);
  --stroke:rgba(255,255,255,.18);
  --surface:rgba(0,0,0,.40);
  --danger:#ff5b62;
  --blue:#0A84FF;         /* iOS blue */
  --greyText:#cfd3e1;

  /* app additions */
  --ink-dim:#cfd3e1;
  --bg:#000;
  --green:#32d74b;
  --gold:#ffd700;
  --silver:#c0c7d1;
  --maxw:1240px;

  /* header sizing */
  --avatarW:44px;
}

*{ box-sizing:border-box }
html, body{ height:100% }
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
}
.no-scroll{ overflow:hidden }

/* ===== Top nav ===== */
.nav{
  position:fixed;
  top:0; left:0; right:0;
  height:64px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  padding:8px 24px;
  z-index:5;
  background:linear-gradient(180deg, rgba(0,0,0,.6), rgba(0,0,0,0));
  overflow:hidden;
}

.logo-block{ display:flex; flex-direction:column; gap:2px; z-index:6; }
.logo{ font-weight:900; letter-spacing:.3px; font-size:clamp(16px, 2.6vw, 20px); color:var(--blue); }
.logo-sub{ font-weight:700; font-size:clamp(12px, 2vw, 15px); color:#fff; opacity:1; margin-left:1px; }

.nav-right{ display:flex; align-items:center; gap:10px; }
.welcome{ color:var(--muted); font-size:14px }

.btn{
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  border-radius:8px; padding:10px 14px; font-weight:700;
  border:1px solid transparent; cursor:pointer;
}
.primary{ background:var(--blue); color:#fff }
.ghost{ background:rgba(0,0,0,.45); border:1px solid var(--stroke); color:var(--ink) }
.btn:hover{ filter:brightness(1.08) }

/* Accessible focus */
a:focus-visible, button:focus-visible, .btn:focus-visible, input:focus-visible{
  outline:2px solid var(--blue);
  outline-offset:2px;
  border-radius:10px;
}

/* ===== Backgrounds ===== */
.hero-wrap, .page-wrap{ min-height:100dvh; position:relative; overflow:hidden; }

.bg{
  position:absolute; inset:0; z-index:0;
  filter:saturate(1.05) contrast(1.05);
}

/* NOTE: removed ?v= cache-busters so static hosting finds them */
.bg.login-bg { background:url("./assets/login-bg.jpg") center/cover no-repeat; }
.bg.home-bg  { background:url("./assets/home-bg.jpg")  center/cover no-repeat; }
.bg.learn-bg { background:url("./assets/learn-bg.jpg") center/cover no-repeat; }

.overlay{
  position:absolute; inset:0; pointer-events:none; z-index:1;
  background:
    linear-gradient(180deg, rgba(0,0,0,.45) 0%, rgba(0,0,0,.78) 75%),
    radial-gradient(80% 60% at 50% 10%, rgba(0,0,0,.45), transparent 70%);
}

.hero-content{ position:relative; z-index:2 }

/* ===== Header tabs & avatar (shrinks to fit) ===== */
.nav-left{ display:flex; gap:8px; min-width:0; flex:1 1 auto; }
.btn-tab{
  display:inline-flex; align-items:center; justify-content:center;
  flex:1 1 0; min-width:0; max-width:120px;
  height:44px; padding:0 12px;
  border-radius:12px; border:1px solid var(--stroke);
  background:rgba(0,0,0,.55); color:var(--ink); font-weight:900; cursor:pointer;
  transition:transform .06s ease, filter .15s ease;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  font-size:clamp(13px, 3.2vw, 16px);
}
.btn-tab:active{ transform:translateY(1px) }
.btn-tab.is-active{ background:var(--blue); border-color:transparent; color:#fff }

.avatarTab{
  position:relative; display:inline-flex; align-items:center; gap:10px;
  padding-right:calc(var(--avatarW) + 12px); height:44px;
}
.avatarTab .points{ font-weight:900 }
.avatarTab .dot{
  position:absolute; right:0; top:0; bottom:0; width:var(--avatarW);
  border-left:1px solid var(--stroke);
  border-top-right-radius:22px; border-bottom-right-radius:22px;
  display:grid; place-items:center; font-weight:900;
}
.avatarTab.silver{ background:var(--silver); color:#0f1116 }
.avatarTab.silver .dot{ background:linear-gradient(135deg,#d9dee6,#b7bec9) }
.avatarTab.gold{ background:var(--gold); color:#0f1116; border-color:transparent }
.avatarTab.gold .dot{ background:linear-gradient(135deg,#ffe88a,#f6c400) }
#avatarInitials{ padding-left:2px; letter-spacing:.2px; }

@media (max-width:390px){
  .btn-tab{ max-width:100px; padding:0 10px; }
}

@media (orientation:portrait){
  :root{ --avatarW:40px; }
  .btn-tab{ height:42px; }
}
@media (orientation:landscape){
  :root{ --avatarW:52px; }
  .btn-tab{ min-width:140px; height:52px; font-size:18px; padding:0 16px; }
  .avatarTab{ height:52px; }
}

/* ===== Home layout ===== */
.wrap{
  position:relative; z-index:1;
  padding-top:96px; padding-left:20px; padding-right:20px; padding-bottom:48px;
}
.section{ margin-top:18px }
.section-title{ margin:10px 2px; font-size:18px; font-weight:800; letter-spacing:.2px; }

/* ===== Hero cards (shared) ===== */
.hero{
  position:relative; overflow:hidden; background:#000;
  border:1px solid var(--stroke); border-radius:16px;
  padding:16px; margin:12px 0;
}
.hero .title{ margin:0 0 6px; font-weight:900; font-size:20px; display:flex; align-items:center; gap:8px }
.hero .meta{ margin:0 0 6px; color:var(--ink-dim) }
.hero .desc{ margin:8px 0 10px; color:var(--muted) }
.cta-left{ position:absolute; left:16px; bottom:14px; display:flex; gap:10px }

/* === Daily hero look (no image overlay) === */
#dailyHero{
  background:
    radial-gradient(160% 100% at 100% 0%, rgba(10,132,255,.18), transparent 60%),
    linear-gradient(135deg, rgba(255,255,255,.05), rgba(255,255,255,.01));
}

/* Daily meta chips */
.meta-chips{ display:flex; flex-wrap:wrap; gap:8px; margin:8px 0 46px; }
.chip{
  display:inline-flex; gap:6px; align-items:center;
  padding:6px 10px; border-radius:999px;
  background:rgba(0,0,0,.45);
  border:1px solid var(--stroke);
  font-size:13px; color:var(--ink);
}
.chip .k{ opacity:.75 }
.chip .v{ font-weight:800 }

/* Padlock (for weekly tiles etc.) */
.padlock{ width:22px; height:22px; display:inline-block; vertical-align:-3px }
.padlock svg{ width:100%; height:100% }
.padlock .shackle{ fill:none; stroke:var(--silver); stroke-width:2.4 }
.padlock .body{ fill:var(--silver) }
.padlock .keyhole{ fill:#0f1116 }

/* Price + Points bubbles */
.price, .pts{
  position:absolute; right:12px; border-radius:999px; font-weight:900; padding:6px 10px;
  background:rgba(0,0,0,.6); border:1px solid var(--stroke)
}
.price{ bottom:12px; color:#fff }
.pts{ top:12px; color:#0f1116; background:var(--gold); border-color:transparent; box-shadow:0 6px 18px rgba(255,215,0,.22) }
.pts[hidden], .price[hidden]{ display:none }

/* Completion ring + tick */
.hero.complete{ box-shadow:0 0 0 3px var(--green) inset }
.hero.complete .title::after{ content:" âœ“"; color:var(--green); font-weight:900 }

/* Weekly grid */
.weekly-grid{ display:grid; gap:12px }
@media (orientation:portrait){
  .weekly-grid{ grid-template-columns:1fr }
  .hero.tall{ min-height: 360px }
  #dailyHero{ min-height: 260px }
}
@media (orientation:landscape){
  .weekly-grid{ grid-template-columns:repeat(3,minmax(0,1fr)) }
  .hero.tall{ min-height: 300px }
  #dailyHero{ min-height: 220px }
}

/* ===== Sheets (Buy & Avatar) ===== */
.sheet-mask{position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);display:none;z-index:60}
.sheet-mask.open{display:block}
.sheet{
  position:fixed; left:0; right:0; bottom:-100%;
  background:#0f1116; border-radius:16px 16px 0 0;
  border:1px solid rgba(255,255,255,.15); padding:14px;
  z-index:61; transition:transform .2s ease, bottom .2s ease
}
.sheet.open{ bottom:0 }
.sheet h3{ margin:0 0 8px; font-size:18px; font-weight:900 }
.sheet .row{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px }
.sheet .meta{ color:#cfd3e1 }

/* Avatar sheet (mobile: backdrop + slide; desktop: dropdown) */
#avatarSheet{
  position:fixed; inset:0; display:none; z-index:60;
  background:
    radial-gradient(120% 80% at 90% 10%, rgba(10,132,255,.10), transparent 60%),
    rgba(0,0,0,.55);
  -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
}
#avatarSheet.open{ display:block; }
#avatarSheet .panel{
  position:absolute; left:0; right:0; bottom:-100%;
  background:#0f1116;
  border-top-left-radius:18px; border-top-right-radius:18px;
  border-top:1px solid var(--stroke);
  padding:18px;
  max-height:80vh; overflow:auto;
  transition:bottom .25s ease;
  box-shadow:
    0 14px 36px rgba(0,0,0,.6),
    0 0 0 1px rgba(10,132,255,.28) inset,
    0 1px 0 rgba(255,255,255,.06) inset;
}
#avatarSheet.open .panel{ bottom:0; }

/* Avatar sheet section accents */
#avatarSheet .row{ border-bottom:1px solid rgba(10,132,255,.12); padding-bottom:6px; }
#avatarSheet .row:last-child{ border-bottom:none }
#avatarSheet h3{ margin:12px 0 6px; font-weight:900; position:relative; }
#avatarSheet h3::after{
  content:""; position:absolute; left:0; bottom:-6px; right:0; height:2px;
  background:linear-gradient(90deg, rgba(10,132,255,.55), rgba(10,132,255,0));
  border-radius:2px;
}
.sheet-footer{
  display:flex; align-items:center; gap:10px;
  margin-top:14px; padding-top:10px;
  border-top:1px dashed rgba(10,132,255,.18);
  color:var(--ink-dim); font-size:13px; opacity:.9;
}
.sheet-footer img{
  width:22px; height:22px; border-radius:6px;
  background:linear-gradient(135deg,#ffe88a,#f6c400);
  display:block;
}
.sheet-footer .byline{ letter-spacing:.2px }
.sheet-footer .brand{ font-weight:800; color:var(--blue) }

/* Desktop/tablet avatar dropdown (no backdrop, no slide) */
@media (min-width:768px){
  #avatarSheet{
    position:absolute; inset:auto; top:64px; right:12px; width:320px;
    background:none; -webkit-backdrop-filter:none; backdrop-filter:none; display:none;
  }
  #avatarSheet.open{ display:block; }
  #avatarSheet .panel{
    position:relative; bottom:auto; max-height:70vh; overflow:auto;
    border-radius:14px; border:1px solid var(--stroke);
    transition:none;
    box-shadow:
      0 16px 40px rgba(0,0,0,.55),
      0 0 0 1px rgba(10,132,255,.22) inset;
  }
}

/* Ensure templates never interfere with layout */
#templates[hidden]{ display:none !important; visibility:hidden !important; }