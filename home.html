<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<title>Home — FAOA</title>

<style>
:root{
  --ink:#eef3ff; --ink-dim:#cfd3e1; --muted:rgba(238,243,255,.78);
  --bg:#000; --stroke:rgba(255,255,255,.18);
  --blue:#0A84FF; --green:#32d74b; --gold:#ffd700; --silver:#c0c7d1;
  --bronze:#b87333; --red:#ff3b30; --black:#111;
  --gap:12px; --r:14px; --maxw:1240px; --nav-h:68px; --btn-h:44px; --btn-bottom:14px;
}
*{box-sizing:border-box}
html,body{
  height:100%; margin:0; background:var(--bg); color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
  overscroll-behavior-y:contain; overscroll-behavior-x:none; overflow-x:hidden;
}
a{color:inherit; text-decoration:none}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

/* Background */
.bg{position:fixed; inset:0; z-index:-1; background:#000 url("./assets/home-bg.jpg") center/cover no-repeat}

/* ===== FIXED TOP BAR (courses only) ===== */
.nav{
  position:fixed; top:0; left:0; right:0; height:var(--nav-h);
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:8px 12px; z-index:100;
  background:linear-gradient(180deg, rgba(0,0,0,.9), rgba(0,0,0,.55) 60%, rgba(0,0,0,.3));
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
}
.nav-left{display:flex; gap:8px; align-items:center}
.nav-title{display:inline-flex; align-items:center; justify-content:center;
  height:44px; padding:0 14px; border-radius:12px; border:1px solid var(--stroke);
  background:rgba(0,0,0,.55); color:var(--ink); font-weight:900; font-size:15px}

/* Avatar pill (text-only; solid colour by role) */
.avatarTab{
  display:flex; flex-direction:column; align-items:flex-start; justify-content:center;
  padding:6px 12px; border-radius:12px; min-width:132px; height:44px;
  font-weight:900; line-height:1.1; text-align:left; cursor:pointer;
  border:1px solid var(--stroke); background:#222;
}
.avatarTab .name{font-size:15px; font-weight:900}
.avatarTab .lvl{font-size:12px; opacity:.95; text-transform:capitalize}

/* Content wrap */
.wrap{max-width:var(--maxw); margin:0 auto; padding:calc(var(--nav-h) + env(safe-area-inset-top) + 10px) 14px 60px}

/* ===== HERO (courses items) ===== */
.hero{
  position:relative; overflow:hidden; background:#060708;
  border:1px solid var(--stroke); border-radius:16px; padding:16px; margin:12px 0;
}
.hero .title{margin:0 0 6px; font-weight:900; font-size:20px}
.hero .meta{margin:0 0 6px; color:var(--ink-dim)}
.hero .desc{margin:8px 0 56px; color:var(--muted)}
.cta-left{position:absolute; left:16px; bottom:var(--btn-bottom); display:flex; gap:10px}
.btn{display:inline-flex; align-items:center; justify-content:center; min-width:130px; height:var(--btn-h); padding:0 16px; border-radius:12px; border:1px solid var(--stroke); font-weight:900; background:#0f1116; color:var(--ink); cursor:pointer}
.btn.blue{background:var(--blue); border-color:transparent; color:#000}
.btn.grey{background:#3a3a3a; color:#fff}

/* Only admin sees this control */
.admin-ctrls{position:absolute; top:10px; right:10px; display:none; gap:6px; z-index:5}
.admin-on .admin-ctrls{display:flex}
.admin-ctrls .ctl{height:28px; padding:0 10px; border-radius:999px; border:1px solid var(--stroke); background:#141416; color:#fff; font-weight:800; font-size:12px; cursor:pointer}
.admin-ctrls .state-live{background:#0a0}
.admin-ctrls .state-off{background:#b00020}

/* Number badge */
.num-badge{position:absolute; top:12px; left:12px; height:26px; padding:0 10px; border-radius:999px; border:1px solid var(--stroke); display:flex; align-items:center; font-weight:900; font-size:13px; background:#0f1116}

/* Avatar Drawer */
#avatarSheet{position:fixed; inset:0; z-index:60; display:none; background:rgba(0,0,0,.45); -webkit-backdrop-filter:blur(4px); backdrop-filter:blur(4px)}
#avatarSheet.open{display:block}
#avatarSheet .panel{position:absolute; top:calc(var(--nav-h) + 6px); right:12px; width:320px; max-height:70vh; overflow:auto; background:#0f1116; border:1px solid var(--stroke); border-radius:14px; padding:12px}
.menu a{display:flex; align-items:center; justify-content:space-between; padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.08)}
.menu a:last-child{border-bottom:none}

/* Subsheet (iframe) */
#subSheet{position:fixed; inset:0; z-index:70; display:none; background:rgba(0,0,0,.55); -webkit-backdrop-filter:blur(6px); backdrop-filter:blur(6px)}
#subSheet.open{display:block}
#subSheet .inner{position:absolute; top:calc(var(--nav-h) + 6px); right:12px; width:min(820px,calc(100% - 24px)); height:min(78vh,calc(100% - (var(--nav-h) + 24px))); background:#0f1116; border:1px solid var(--stroke); border-radius:14px; padding:12px; display:flex; flex-direction:column}
.sheet-head{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:4px 4px 10px}
.sheet-head h2{margin:0; font-size:22px; font-weight:900}
.sheet-close{width:36px; height:36px; border-radius:10px; border:1px solid var(--stroke); background:#121212; color:#fff; font-weight:900; cursor:pointer}
#subFrame{flex:1 1 auto; width:100%; height:100%; border:none; border-radius:12px; background:#0b0c10; overflow:hidden}
</style>
</head>
<body>
<div class="bg" aria-hidden="true"></div>

<header class="nav" role="navigation" aria-label="Primary">
  <div class="nav-left">
    <div class="nav-title">Courses</div>
  </div>
  <div class="nav-right">
    <button id="avatarTab" class="avatarTab" aria-haspopup="dialog" aria-expanded="false">
      <span class="name" id="avatarName">User</span>
      <span class="lvl" id="avatarLvl">Admin</span>
    </button>
  </div>
</header>

<main class="wrap">
  <!-- ===== COURSES ONLY (10 placeholders) ===== -->
  <section id="panel-courses" data-panel="courses">
    <!-- co-1 ... co-10, blank heroes with number badge + Start + admin live/off -->
    <!-- Template repeated -->
    <article class="hero" data-hero-id="co-1">
      <span class="num-badge">#1</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-2">
      <span class="num-badge">#2</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-3">
      <span class="num-badge">#3</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-4">
      <span class="num-badge">#4</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-5">
      <span class="num-badge">#5</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-6">
      <span class="num-badge">#6</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-7">
      <span class="num-badge">#7</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-8">
      <span class="num-badge">#8</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-9">
      <span class="num-badge">#9</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
    <article class="hero" data-hero-id="co-10">
      <span class="num-badge">#10</span>
      <div class="admin-ctrls"><button class="ctl state-live" data-toggle-state>Live</button></div>
      <div class="cta-left"><button class="btn blue" data-start>Start</button></div>
    </article>
  </section>
</main>

<!-- ===== AVATAR DRAWER ===== -->
<div id="avatarSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel" role="document">
    <nav class="menu">
      <a href="avatar/profile.html" data-pop="Profile">Profile<span>›</span></a>
      <a href="avatar/settings.html" data-pop="Settings">Settings<span>›</span></a>
      <a href="avatar/mydata.html" data-pop="My Data">My Data<span>›</span></a>
      <a href="avatar/challengetracker.html" data-pop="Challenge Tracker">Challenge Tracker<span>›</span></a>
      <a href="avatar/statistics.html" data-pop="Statistics">Statistics<span>›</span></a>
      <a href="avatar/usersearch.html" data-pop="User Search">User Search<span>›</span></a>
    </nav>
  </div>
</div>

<!-- ===== SUB SHEET ===== -->
<div id="subSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="inner" role="document">
    <div class="sheet-head">
      <h2 id="sheetTitle">—</h2>
      <button class="sheet-close" id="sheetClose" aria-label="Close">×</button>
    </div>
    <iframe id="subFrame" title="Panel"></iframe>
  </div>
</div>

<script>
(()=>{'use strict';
/* ===== utils & storage ===== */
const $=s=>document.querySelector(s);
const $$=s=>Array.from(document.querySelectorAll(s));
const store={get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
             set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};

/* Keys */
const K={ profile:'ao_profile', flags:'ao_course_flags', heroLinks:'ao_course_links' };

/* Role skin + admin gate (you can later set via profile.html) */
function currentRole(){ const p=store.get(K.profile,null); return (p?.skill||'admin').toLowerCase(); }
function isAdmin(){ return currentRole()==='admin'; }
const ROLE_SKINS={
  bronze:{pill:'var(--bronze)', text:'#111'},
  silver:{pill:'var(--silver)', text:'#0b0c10'},
  gold:{pill:'var(--gold)', text:'#0b0c10'},
  support:{pill:'#6a4cff', text:'#fff'},
  director:{pill:'#444', text:'#fff'},
  admin:{pill:'var(--blue)', text:'#0b0c10'}
};

/* Paint avatar pill */
function applyProfile(){
  const p=store.get(K.profile,{displayName:'User',skill:'admin'});
  const role=(p.skill||'admin').toLowerCase();
  const skin=ROLE_SKINS[role]||ROLE_SKINS.silver;
  $('#avatarName').textContent=p.displayName||'User';
  $('#avatarLvl').textContent=role.charAt(0).toUpperCase()+role.slice(1);
  const pill=$('#avatarTab'); pill.style.background=skin.pill; pill.style.color=skin.text;
  document.body.classList.toggle('admin-on', isAdmin());
}
applyProfile();

/* Avatar Drawer & Subsheet */
const avatarBtn=$('#avatarTab'), avatarSheet=$('#avatarSheet');
function openDrawer(){ avatarSheet.classList.add('open'); avatarSheet.setAttribute('aria-hidden','false'); avatarBtn.setAttribute('aria-expanded','true'); }
function closeDrawer(){ avatarSheet.classList.remove('open'); avatarSheet.setAttribute('aria-hidden','true'); avatarBtn.setAttribute('aria-expanded','false'); }
avatarBtn.addEventListener('click', openDrawer);
avatarSheet.addEventListener('click', e=>{ if(e.target===avatarSheet) closeDrawer(); });

const subSheet=$('#subSheet'), subFrame=$('#subFrame'), sheetTitle=$('#sheetTitle');
function openSubSheet(title,url){
  sheetTitle.textContent=title;
  subFrame.src=url+(url.includes('?')?'&':'?')+'v='+Date.now();
  subFrame.addEventListener('load', ()=>{
    try{
      const d=subFrame.contentDocument||subFrame.contentWindow.document;
      const st=d.createElement('style'); st.textContent='html,body{overflow-x:hidden!important}'; d.head.appendChild(st);
    }catch{}
  }, {once:true});
  subSheet.classList.add('open'); subSheet.setAttribute('aria-hidden','false');
}
function closeSubSheet(){ subSheet.classList.remove('open'); subSheet.setAttribute('aria-hidden','true'); subFrame.src='about:blank'; }
$('#sheetClose').addEventListener('click', closeSubSheet);
subSheet.addEventListener('click', e=>{ if(e.target===subSheet) closeSubSheet(); });
$$('#avatarSheet [data-pop]').forEach(a=>{
  a.addEventListener('click',e=>{
    e.preventDefault(); closeDrawer(); openSubSheet(a.dataset.pop, a.getAttribute('href'));
  });
});

/* ===== Course hero flags & links =====
   flags[id] = { state:'live'|'off' }
   links[id] = "relative-or-absolute-url"
*/
function getFlags(){ return store.get(K.flags,{}); }
function setFlag(id, next){ const f=getFlags(); f[id]=Object.assign({state:'live'},f[id]||{}, next); store.set(K.flags,f); }
function getLink(id){ const L=store.get(K.heroLinks,{}); return L[id]||''; }
function setLink(id,url){ const L=store.get(K.heroLinks,{}); L[id]=url; store.set(K.heroLinks,L); }

/* Paint visibility + admin button state */
function paintHeroes(){
  const f=getFlags();
  $$('[data-hero-id]').forEach(el=>{
    const id=el.dataset.heroId;
    const flag=f[id]||{state:'live'};
    // hide from non-admin when offline
    const show = isAdmin() ? true : (flag.state==='live');
    el.style.display = show ? '' : 'none';

    // admin button label/style
    const btn=el.querySelector('[data-toggle-state]');
    if(btn){
      btn.textContent = (flag.state==='live'?'Live':'Offline');
      btn.classList.toggle('state-live', flag.state==='live');
      btn.classList.toggle('state-off', flag.state!=='live');
    }
  });
}
paintHeroes();

/* Handle Live/Offline toggle (admin only) & Start button */
document.body.addEventListener('click',(e)=>{
  // Toggle live/offline
  if(e.target.matches('[data-toggle-state]')){
    if(!isAdmin()){ return; }
    const hero=e.target.closest('[data-hero-id]'); const id=hero?.dataset.heroId;
    const f=getFlags()[id]||{state:'live'};
    const next = (f.state==='live'?'off':'live');
    const ok=confirm(`Set ${id} ${next==='live'?'LIVE (visible to users)':'OFFLINE (hidden from users)'}?`);
    if(!ok) return;
    setFlag(id,{state:next}); paintHeroes(); return;
  }

  // Start button
  if(e.target.matches('[data-start]')){
    const hero=e.target.closest('[data-hero-id]'); const id=hero?.dataset.heroId;
    const url=getLink(id);
    if(url){
      openSubSheet('Course', url);
    }else{
      if(isAdmin()){
        const u=prompt(`No link set for ${id}. Enter linked HTML/URL:`,`courses/${id}.html`);
        if(u!=null && u.trim()!==''){ setLink(id,u.trim()); openSubSheet('Course', u.trim()); }
      }else{
        alert('Coming soon.');
      }
    }
  }
});

/* Respond to external profile/role changes (from profile/settings pages) */
window.addEventListener('storage', e=>{
  if(e.key===K.profile){ applyProfile(); paintHeroes(); }
  if(e.key===K.flags){ paintHeroes(); }
});

console.log('[FAOA] courses-only home loaded ✓');
})();
</script>
</body>
</html>