<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<title>Home — FAOA</title>

<style>
:root{
  --ink:#eef3ff; --ink-dim:#cfd3e1; --muted:rgba(238,243,255,.78);
  --bg:#000; --stroke:rgba(255,255,255,.18);
  --blue:#0A84FF; --green:#32d74b; --gold:#ffd700; --silver:#c0c7d1; --red:#ff453a;
  --gap:12px; --r:14px; --maxw:1240px; --nav-h:68px;

  --btn-h:44px;     /* button height */
  --btn-bottom:14px;
  --chip-h:36px;    /* chip visual height */
}
*{box-sizing:border-box}
html,body{height:100%; overflow-x:hidden}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
  -webkit-user-select:none; user-select:none; -webkit-touch-callout:none;
}
a{color:inherit; text-decoration:none}

/* Background */
.bg{ position:fixed; inset:0; z-index:-1; background:#000 url("./assets/home-bg.jpg") center/cover no-repeat; }

.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0 }
.hide{ display:none !important }
.section-title{ margin:18px 2px 8px; font-size:18px; font-weight:900 }
.wrap{max-width:var(--maxw); margin:0 auto; padding:10px 14px 80px}

/* Buttons */
.btn{ display:inline-flex; align-items:center; justify-content:center; min-width:156px; height:var(--btn-h); padding:0 16px;
      border-radius:12px; border:0; font-weight:900; cursor:pointer; font-family:inherit; }
.btn.blue{ background:var(--blue); color:#fff }
.btn.green{ background:var(--green); color:#000 }
.btn.gold{ background:var(--gold); color:#0f1116 }
.btn.grey{ background:#3a3a3a; color:#fff }
.btn[disabled]{ opacity:.55; cursor:not-allowed }

/* ===== HEADER ===== */
.nav{
  position:sticky; top:0; left:0; right:0; height:var(--nav-h);
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:8px 12px; z-index:40;
  background:linear-gradient(180deg, rgba(0,0,0,.85), rgba(0,0,0,.35) 60%, transparent);
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
}
.nav-left{display:flex; gap:8px; align-items:center; flex:1 1 auto; min-width:0}
.nav-right{margin-left:auto; display:flex; align-items:center}
.btn-tab{
  display:inline-flex; align-items:center; justify-content:center;
  flex:1 1 0; min-width:0; max-width:120px;
  height:44px; padding:0 12px;
  border-radius:12px; border:1px solid var(--stroke);
  background:rgba(0,0,0,.55); color:var(--ink); font-weight:900; cursor:pointer;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  transition:transform .06s ease, filter .15s ease;
  font-size:clamp(13px, 3.2vw, 16px);
}
.btn-tab:active{transform:translateY(1px)}
.btn-tab.is-active{background:var(--blue); border-color:transparent; color:#fff}

/* Avatar tab (initials perfectly centered) */
.avatarTab{ position:relative; display:inline-flex; align-items:center; gap:10px; padding-right:56px; height:44px }
.avatarTab .points{ font-weight:900 }
.avatarTab .dot{
  position:absolute; right:0; top:0; bottom:0; width:44px;
  border-left:1px solid var(--stroke);
  border-top-right-radius:22px; border-bottom-right-radius:22px;
  display:flex; align-items:center; justify-content:center; font-weight:900;
  transform: translateX(1px);
}
.avatarTab.silver{ background:var(--silver); color:#0f1116 }
.avatarTab.silver .dot{ background:linear-gradient(135deg,#d9dee6,#b7bec9) }
.avatarTab.gold{ background:var(--gold); color:#0f1116; border-color:transparent }
.avatarTab.gold .dot{ background:linear-gradient(135deg,#ffe88a,#f6c400) }

@media (max-width:390px){ .btn-tab{ max-width:96px; padding:0 10px } #avatarTab{ padding-right:52px } }

/* ===== HERO base ===== */
.hero{
  position:relative; overflow:hidden; background:#000;
  border:1px solid var(--stroke); border-radius:16px;
  padding:16px; margin:12px 0;
}
.hero .title{ margin:0 0 6px; font-weight:900; font-size:20px; display:flex; align-items:center; gap:8px }
.hero .meta{ margin:0 0 6px; color:var(--ink-dim) }
.hero .desc{ margin:8px 0 56px; color:var(--muted) }
.cta-left{ position:absolute; left:16px; bottom:var(--btn-bottom); display:flex; gap:10px }

/* ===== Daily hero (gloss + level) ===== */
#dailyHero{ color:#eef3ff; position:relative; }
#dailyHero::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:linear-gradient(120deg, rgba(255,255,255,.35) 0%, rgba(255,255,255,.10) 30%, rgba(255,255,255,0) 60%);
  mix-blend-mode:screen;
}
#dailyHero .level{
  position:absolute; top:12px; right:16px;
  font-weight:800; font-size:18px; letter-spacing:.5px; z-index:1;
}

/* Chips at bottom-right (row on large, vertical on small portrait) */
#dailyHero .meta-chips{
  position:absolute; right:16px;
  bottom: calc(var(--btn-bottom) + (var(--btn-h)/2) - (var(--chip-h)/2));
  display:flex; gap:8px; flex-wrap:wrap; margin:0; justify-content:flex-end;
}
.chip{
  display:inline-flex; align-items:center; gap:6px;
  height:var(--chip-h); padding:0 12px; border-radius:999px;
  background:rgba(0,0,0,.45); border:1px solid var(--stroke);
  color:var(--ink); font-weight:700; font-size:13px;
}
.chip .k{ opacity:.75; font-weight:700 } .chip .v{ font-weight:900 }

/* Small portrait: stack chips vertically, largest on bottom (column-reverse) */
@media (max-width:480px) and (orientation:portrait){
  #dailyHero .meta-chips{
    flex-direction:column-reverse; align-items:flex-end;
    bottom:12px; right:12px;
  }
  .chip{ width: max-content; }
}

/* Skins */
#dailyHero[data-skin="bronze"]{ background:linear-gradient(135deg,#5e3515,#b86b2e 40%,#ffb067 70%,#5e3515 95%); color:#fff }
#dailyHero[data-skin="silver"]{ background:linear-gradient(135deg,#7c838a,#cfd6dd 35%,#f7f9fa 60%,#7c838a 90%); color:#111 }
#dailyHero[data-skin="gold"]{ background:linear-gradient(135deg,#9c7a00,#d4af37 35%,#ffe680 65%,#9c7a00 95%); color:#111 }
#dailyHero[data-skin="black"]{ background:linear-gradient(135deg,#000,#222 30%,#444 50%,#111 70%,#000 95%); color:#fff; border-color:rgba(255,255,255,.22) }

/* Embossing */
#dailyHero[data-skin="bronze"] .level,
#dailyHero[data-skin="silver"] .level,
#dailyHero[data-skin="gold"]   .level{ color:inherit; text-shadow:1px 1px 2px rgba(0,0,0,.6), -1px -1px 2px rgba(255,255,255,.3) }
#dailyHero[data-skin="black"] .level{ background:linear-gradient(135deg,#ffd54a,#f6c400); -webkit-background-clip:text; -webkit-text-fill-color:transparent; text-shadow:1px 1px 3px rgba(0,0,0,.9) }

/* Complete ring & tick */
.hero.complete{ box-shadow:0 0 0 3px var(--green) inset }
.hero.complete .title::after{ content:" ✓"; color:var(--green); font-weight:900 }

/* ===== Weekly hero (single) ===== */
#weeklyHero{ background:linear-gradient(135deg,#0b0f16,#1b2230 60%, #0d1320 95%) }
#weeklyHero .badge{
  position:absolute; top:12px; left:16px; font-weight:900; opacity:.95;
  background:rgba(255,255,255,.08); border:1px solid var(--stroke);
  padding:6px 10px; border-radius:999px; font-size:13px;
}
#weeklyHero .meta-chips{
  position:absolute; right:16px;
  bottom: calc(var(--btn-bottom) + (var(--btn-h)/2) - (var(--chip-h)/2));
  display:flex; gap:8px; flex-wrap:wrap; margin:0; justify-content:flex-end;
}
@media (max-width:480px) and (orientation:portrait){
  #weeklyHero .meta-chips{ position:static; margin-top:10px; justify-content:flex-start }
}

/* ===== Tracker ===== */
.tracker .cards{ display:grid; grid-template-columns:1fr 1fr; gap:var(--gap) }
@media (max-width:720px){ .tracker .cards{ grid-template-columns:1fr } } /* daily on top of weekly */
.tracker .card{ border:1px solid var(--stroke); border-radius:12px; padding:12px; background:rgba(255,255,255,.03) }
.tracker .kpi{ display:flex; align-items:center; gap:8px; color:var(--ink-dim); font-weight:700 }
.tracker .kpi .dot{ width:8px; height:8px; border-radius:50%; background:var(--green) }

.medals{ display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; margin-top:10px }
.medalWrap{ display:flex; flex-direction:column; align-items:center; gap:6px }
.medal{
  width:30px; height:30px; border-radius:50%; border:2px solid rgba(255,255,255,.22);
  display:flex; align-items:center; justify-content:center; font-size:15px; font-weight:900; color:#fff;
}
.medal.empty{ background:transparent; color:transparent; border-color:rgba(255,255,255,.18) }
.medal .tick{ transform:translateY(-.5px) }
.medal-label{ font-size:11px; color:var(--ink-dim); letter-spacing:.2px }

/* medal colorways */
.m-bronze{ background:linear-gradient(135deg,#5e3515,#b86b2e 60%,#5e3515) }
.m-silver{ background:linear-gradient(135deg,#7c838a,#cfd6dd 60%,#7c838a); color:#111 }
.m-gold{ background:linear-gradient(135deg,#9c7a00,#d4af37 60%,#9c7a00); color:#111 }
.m-black{ background:linear-gradient(135deg,#000,#333 60%,#000) }

/* Misc responsive heights */
@media (orientation:portrait){ .hero.tall{ min-height:360px } #dailyHero,#weeklyHero{ min-height:220px } }
@media (orientation:landscape){ .weekly-grid{ grid-template-columns:repeat(3,minmax(0,1fr)) } .hero.tall{ min-height:300px } #dailyHero,#weeklyHero{ min-height:220px } }

/* ===== Avatar Drawer (same on all devices) ===== */
#avatarSheet{ position:fixed; inset:0; z-index:60; display:none; background:rgba(0,0,0,.45); -webkit-backdrop-filter:blur(4px); backdrop-filter:blur(4px) }
#avatarSheet.open{ display:block }
#avatarSheet .panel{
  position:absolute; top:64px; right:12px; width:320px; max-height:70vh; overflow:auto;
  background:#0f1116; border:1px solid var(--stroke); border-radius:14px;
  box-shadow: 0 16px 40px rgba(0,0,0,.55), 0 0 0 1px rgba(10,132,255,.22) inset;
  padding:12px; transform:translateY(-8px); opacity:0; transition:transform .18s ease, opacity .18s ease;
}
#avatarSheet.open .panel{ transform:translateY(0); opacity:1 }
.menu a{ display:flex; align-items:center; justify-content:space-between; padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.08) }
.menu a:last-child{ border-bottom:none }
.brandfoot{ display:flex; flex-direction:column; gap:4px; align-items:flex-start; padding:12px 10px 4px; color:#fff }
.brandfoot .t1{ color:var(--blue); font-weight:900 }
.brandfoot .t2{ opacity:.9; font-size:13px }

#templates[hidden]{ display:none !important; visibility:hidden !important; }
</style>
</head>
<body>

<div class="bg" aria-hidden="true"></div>

<header class="nav">
  <div class="nav-left" role="tablist" aria-label="Primary">
    <button class="btn-tab is-active" data-tab="challenges" aria-selected="true">Challenges</button>
    <button class="btn-tab" data-tab="courses" aria-selected="false">Courses</button>
    <button class="btn-tab" data-tab="live" aria-selected="false">Live</button>
  </div>
  <div class="nav-right">
    <button id="avatarTab" class="btn-tab avatarTab silver" aria-haspopup="dialog" aria-expanded="false">
      <span class="points" id="pointsBadge">0</span>
      <span class="dot" id="avatarInitials">JG</span>
    </button>
  </div>
</header>

<main class="wrap">
  <!-- Challenges -->
  <section id="panel-challenges" data-panel="challenges">

    <!-- DAILY -->
    <article class="hero" id="dailyHero" aria-labelledby="dailyTitle" data-skin="bronze">
      <h2 class="title" id="dailyTitle">Daily Challenge</h2>
      <p class="meta" id="dailyDate">—</p>

      <!-- injected: <div class="level" id="dailyLevel">Beginner</div> -->

      <div id="dailyContent">
        <p class="desc">New prompt coming soon.</p>
        <div class="meta-chips"></div>
      </div>

      <div class="cta-left"><button class="btn blue" id="btnDaily">Complete</button></div>
    </article>

    <!-- WEEKLY (single hero) -->
    <article class="hero" id="weeklyHero" aria-labelledby="weeklyTitle">
      <div class="badge">Weekly Challenge</div>
      <h2 class="title" id="weeklyTitle">—</h2>
      <p class="meta" id="weeklyMeta">—</p>
      <p class="desc" id="weeklyDesc">Design focus for the week.</p>
      <div class="cta-left"><a class="btn blue" id="btnWeekly" href="#" aria-disabled="true">Start Challenge</a></div>
      <div class="meta-chips" id="weeklyChips"></div>
    </article>

    <!-- TRACKER -->
    <article class="hero tracker" id="trackerHero" aria-labelledby="trackerTitle">
      <h2 class="title" id="trackerTitle">Challenge Tracker</h2>
      <p class="meta">See your recent progress.</p>

      <div class="cards">
        <div class="card">
          <div class="kpi"><span class="dot"></span>Daily (7d)</div>
          <div class="medals" id="dailyMedals"></div>
        </div>
        <div class="card">
          <div class="kpi"><span class="dot" style="background:#0A84FF"></span>Weekly (6w)</div>
          <div class="medals" id="weeklyMedals"></div>
        </div>
      </div>
    </article>

  </section>

  <!-- Courses -->
  <section id="panel-courses" class="hide" data-panel="courses">
    <h2 class="section-title">Foundations (Subscribers)</h2>
    <div class="weekly-grid" id="foundationsGrid"></div>

    <h2 class="section-title">1-Day Courses</h2>
    <div class="weekly-grid" id="oneDayGrid"></div>

    <h2 class="section-title">3-Day Courses</h2>
    <div class="weekly-grid" id="threeDayGrid"></div>

    <h2 class="section-title">30-Day Courses</h2>
    <div class="weekly-grid" id="thirtyDayGrid"></div>
  </section>

  <!-- Live -->
  <section id="panel-live" class="hide" data-panel="live">
    <h2 class="section-title">Demonstrations</h2>
    <div class="weekly-grid" id="demoGrid"></div>
  </section>
</main>

<!-- ===== AVATAR DRAWER (same on all devices) ===== -->
<div id="avatarSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel" role="document">
    <nav class="menu">
      <a href="profile.html">Profile<span>›</span></a>
      <a href="bookings.html">Booked Classes<span>›</span></a>
      <a href="#trackerHero">Challenge Tracker<span>›</span></a>
      <a href="about.html">About<span>›</span></a>
      <a href="contact.html">Contact Us<span>›</span></a>
      <a href="settings.html">Settings<span>›</span></a>
    </nav>
    <div class="brandfoot">
      <div class="t1">Online Art</div>
      <div class="t2">by Jody Graham</div>
    </div>
  </div>
</div>

<!-- ===== PRICING / REGISTRY (inline fallback) ===== -->
<script id="pricingData" type="application/json">
{
  "1d-gesture":{"price":"$39","points":300},
  "3d-portrait":{"price":"$79","points":500},
  "30d-foundations":{"price":"$149","points":1500},
  "live-1":{"price":"$29","points":1800}
}
</script>
<script id="registryData" type="application/json">
{
  "foundations": [
    { "id": "found-setup", "slug": "found-setup", "title": "Materials & Setup", "showOnHome": true },
    { "id": "found-drawing", "slug": "found-drawing", "title": "Drawing", "showOnHome": true },
    { "id": "found-painting", "slug": "found-painting", "title": "Painting", "showOnHome": true }
  ],
  "courses": {
    "1day": [
      { "id": "1d-gesture", "slug": "1d-gesture", "title": "1-Day Gesture", "price": "$39", "points": 300, "showOnHome": true }
    ],
    "3day": [
      { "id": "3d-portrait", "slug": "3d-portrait", "title": "3-Day Portrait", "price": "$79", "points": 500, "showOnHome": true }
    ],
    "30day": [
      { "id": "30d-foundations", "slug": "30d-foundations", "title": "30-Day Drawing Habit", "price": "$149", "points": 1500, "showOnHome": false }
    ]
  },
  "weekly": [
    { "id": "W1", "title": "Ink Portrait", "desc":"Design focus for the week.", "expires": "2025-09-14", "showOnHome": true }
  ],
  "live": [
    { "id": "live-1", "title": "Saturday Studio", "price": "$29", "points": 1800, "starts": "2025-09-20T09:00:00+10:00", "showOnHome": true }
  ],
  "demos": [
    { "id": "demo-coming", "title": "Demonstrations", "comingSoon": true, "showOnHome": true }
  ]
}
</script>

<script>
(()=>{'use strict';
const $=s=>document.querySelector(s);
const $$=s=>Array.from(document.querySelectorAll(s));
const pad=n=>String(n).padStart(2,'0');
const toISO=d=>d.toISOString().slice(0,10);
const cap=s=>(s||'').replace(/\b\w/g,m=>m.toUpperCase());
const dayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

const K={
  sub:'ao_sub', points:'ao_points',
  purchasedA:'ao_purchased', purchasedB:'ao_purchasedCourses',
  weeklyDone:'ao_weekly_done', dailyDone:'ao_daily_done',
  dailyMeta:'ao_daily_meta'
};
const store={ get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
              set:(k,v)=>localStorage.setItem(k,JSON.stringify(v)), del:k=>localStorage.removeItem(k) };

let isSub=!!store.get(K.sub,false);
let points=+store.get(K.points,0);
let purchased=(store.get(K.purchasedB,null)??store.get(K.purchasedA,[])); if(!Array.isArray(purchased)) purchased=[];
let weeklyDone=store.get(K.weeklyDone,[]);
let dailyDone=store.get(K.dailyDone,[]);
let dailyMeta=store.get(K.dailyMeta,{});

const avatarBtn=$('#avatarTab'), avatarSheet=$('#avatarSheet'), pointsBadge=$('#pointsBadge');
function compactK(n){ return (n>=1000? ((Math.round(n/100)/10).toFixed(1).replace(/\.0$/,'')+'k'): String(n)); }
function paintAvatar(){ pointsBadge.textContent = compactK(points); avatarBtn.classList.toggle('gold', isSub); avatarBtn.classList.toggle('silver', !isSub); }
paintAvatar();
avatarBtn.addEventListener('click', ()=>{
  const open=!avatarSheet.classList.contains('open');
  avatarSheet.classList.toggle('open',open);
  avatarSheet.setAttribute('aria-hidden', open ? 'false' : 'true');
  avatarBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
});
avatarSheet.addEventListener('click', (e)=>{ if(e.target===avatarSheet){ avatarSheet.classList.remove('open'); avatarSheet.setAttribute('aria-hidden','true'); avatarBtn.setAttribute('aria-expanded','false'); }});
window.addEventListener('keydown',(e)=>{ if(e.key==='Escape'){ avatarSheet.classList.remove('open'); avatarSheet.setAttribute('aria-hidden','true'); avatarBtn.setAttribute('aria-expanded','false'); }});

/* Tabs */
const tabBtns=$$('.btn-tab[data-tab]'); const panels=$$('[data-panel]');
tabBtns.forEach(b=>b.addEventListener('click', ()=>{
  tabBtns.forEach(x=>{x.classList.toggle('is-active',x===b); x.setAttribute('aria-selected', x===b?'true':'false');});
  panels.forEach(p=>p.classList.toggle('hide', p.dataset.panel!==b.dataset.tab));
  window.scrollTo({top:0,behavior:'smooth'});
}));

/* Dates */
const today=new Date(), isoToday=toISO(today);
$('#dailyDate').textContent=`${dayNames[today.getDay()]} ${pad(today.getDate())}/${pad(today.getMonth()+1)}`;

/* Daily done toggle */
function paintDaily(){
  const done = dailyDone.includes(isoToday);
  $('#btnDaily').textContent = done?'Undo':'Complete';
  $('#btnDaily').className = 'btn ' + (done?'grey':'blue');
  $('#dailyHero').classList.toggle('complete', done);
  paintTracker();
}
paintDaily();
$('#btnDaily').addEventListener('click', ()=>{
  const i=dailyDone.indexOf(isoToday);
  if(i===-1) dailyDone.push(isoToday); else dailyDone.splice(i,1);
  store.set(K.dailyDone,dailyDone); paintDaily();
});

/* Daily loader + skin & level */
async function loadDailyFromHTML(){
  const target=$('#dailyContent');
  try{
    const res=await fetch('./challenges/daily/today.html',{cache:'no-store'});
    if(!res.ok) throw 0;
    target.innerHTML=await res.text();
  }catch{
    target.innerHTML=`<p class="desc">New prompt coming soon.</p><div class="meta-chips"></div>`;
  }
}
function applyDailySkinAndLevel(){
  const host=$('#dailyHero');
  const chips=[...document.querySelectorAll('#dailyContent .chip')];
  let lvl='';
  chips.forEach(ch=>{
    const k=(ch.querySelector('.k')?.textContent||'').toLowerCase();
    if(k.includes('level')){ lvl=(ch.querySelector('.v')?.textContent||'').trim().toLowerCase(); ch.remove(); }
  });
  const map={ beginner:'bronze', intermediate:'silver', advanced:'gold', expert:'black' };
  const skin=map[lvl]||'bronze';
  host.setAttribute('data-skin', skin);
  const label = lvl ? cap(lvl) : 'Beginner';
  let el=$('#dailyLevel'); if(!el){ el=document.createElement('div'); el.id='dailyLevel'; el.className='level'; host.appendChild(el); }
  el.textContent=label;
  // persist skin for tracker medals
  const iso=isoToday; dailyMeta[iso]={skin}; store.set(K.dailyMeta,dailyMeta);
}
(async()=>{ await loadDailyFromHTML(); applyDailySkinAndLevel(); })();

/* Weekly hero (single) */
async function loadRegistry(){
  try{
    const res=await fetch('./data/registry.json',{cache:'no-store'});
    if(!res.ok) throw 0;
    return await res.json();
  }catch{
    try{ return JSON.parse(document.getElementById('registryData').textContent||'{}'); }
    catch{ return {}; }
  }
}
function renderCourses(reg){
  const fGrid=$('#foundationsGrid'); fGrid.innerHTML='';
  (reg.foundations||[]).filter(x=>x.showOnHome!==false).forEach(item=>{
    const a=document.createElement('article'); a.className='hero tall course'; a.dataset.id=item.id;
    a.innerHTML=`<h3 class="title">${item.title}</h3>
      <p class="meta">Subscriber-only foundations.</p>
      <p class="desc">Core drills to build accuracy and flow.</p>
      <div class="cta-left"><a class="btn blue" href="courses/${item.slug||item.id}.html">Start Course</a></div>`;
    fGrid.appendChild(a);
  });
  const one=$('#oneDayGrid'); one.innerHTML='';
  (reg.courses?.["1day"]||[]).filter(x=>x.showOnHome!==false).forEach(item=>{
    const a=document.createElement('article'); a.className='hero tall course'; a.dataset.id=item.id;
    a.innerHTML=`<h3 class="title">${item.title}</h3>
      <p class="meta">Structured, focused learning.</p>
      <p class="desc">Replace with course description.</p>
      <div class="cta-left"><a class="btn green" href="courses/${item.slug||item.id}.html">Buy</a></div>`;
    one.appendChild(a);
  });
  const three=$('#threeDayGrid'); three.innerHTML='';
  (reg.courses?.["3day"]||[]).filter(x=>x.showOnHome!==false).forEach(item=>{
    const a=document.createElement('article'); a.className='hero tall course'; a.dataset.id=item.id;
    a.innerHTML=`<h3 class="title">${item.title}</h3>
      <p class="meta">Structured, focused learning.</p>
      <p class="desc">Replace with course description.</p>
      <div class="cta-left"><a class="btn green" href="courses/${item.slug||item.id}.html">Buy</a></div>`;
    three.appendChild(a);
  });
  const thirty=$('#thirtyDayGrid'); thirty.innerHTML='';
  (reg.courses?.["30day"]||[]).filter(x=>x.showOnHome!==false).forEach(item=>{
    const a=document.createElement('article'); a.className='hero tall course'; a.dataset.id=item.id;
    a.innerHTML=`<h3 class="title">${item.title}</h3>
      <p class="meta">Structured, focused learning.</p>
      <p class="desc">Replace with course description.</p>
      <div class="cta-left"><a class="btn green" href="courses/${item.slug||item.id}.html">Buy</a></div>`;
    thirty.appendChild(a);
  });

  const demoGrid=$('#demoGrid'); demoGrid.innerHTML='';
  (reg.live||[]).filter(x=>x.showOnHome!==false).forEach(l=>{
    const a=document.createElement('article'); a.className='hero tall live';
    a.innerHTML=`<h3 class="title">${l.title}</h3>
      <p class="meta">Starts ${new Date(l.starts||Date.now()).toLocaleString()}</p>
      <p class="desc">Live session.</p>
      <div class="cta-left"><a class="btn blue" href="live/${l.id}.html">View</a></div>`;
    demoGrid.appendChild(a);
  });
}
function paintWeeklyHero(item){
  const titleEl=$('#weeklyTitle'), metaEl=$('#weeklyMeta'), descEl=$('#weeklyDesc'), btn=$('#btnWeekly'), chips=$('#weeklyChips');
  if(!item){ titleEl.textContent='Weekly Challenge'; metaEl.textContent='—'; btn.setAttribute('aria-disabled','true'); btn.removeAttribute('href'); chips.innerHTML=''; return; }
  titleEl.textContent=item.title||'Weekly Challenge';
  const end=item.expires? new Date(item.expires):null;
  metaEl.textContent=end?`Ends ${['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][end.getDay()]} ${String(end.getDate()).padStart(2,'0')}/${String(end.getMonth()+1).padStart(2,'0')}`:'This week';
  descEl.textContent=item.desc||'Design focus for the week.';
  btn.removeAttribute('aria-disabled'); btn.href=`challenges/weekly-${item.id}.html`;
  chips.innerHTML='';
}
loadRegistry().then(reg=>{ renderCourses(reg); const one=(reg.weekly||[])[0]||null; paintWeeklyHero(one); });

/* ===== Tracker ===== */
function startOfWeek(d){ const x=new Date(d); const day=(x.getDay()+6)%7; x.setDate(x.getDate()-day); x.setHours(0,0,0,0); return x; }
function addDays(d,n){ const x=new Date(d); x.setDate(x.getDate()+n); return x; }
function weekKey(d){ const s=startOfWeek(d); return s.toISOString().slice(0,10); }

function medalEl(done, label, skinClass){
  const wrap=document.createElement('div'); wrap.className='medalWrap';
  const m=document.createElement('div'); m.className='medal ' + (done?(skinClass||'m-silver'):'empty');
  if(done) m.innerHTML='<span class="tick">✓</span>';
  const l=document.createElement('div'); l.className='medal-label'; l.textContent=label;
  wrap.appendChild(m); wrap.appendChild(l); return wrap;
}

function paintTracker(){
  // Daily: Mon..Sun of current week
  const wrapD=$('#dailyMedals'); wrapD.innerHTML='';
  const start=startOfWeek(new Date());
  const dayLbl=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
  for(let i=0;i<7;i++){
    const dt=addDays(start,i), iso=toISO(dt);
    const done=dailyDone.includes(iso);
    const skin=dailyMeta[iso]?.skin; const skinClass=skin?('m-'+skin):'m-bronze';
    wrapD.appendChild(medalEl(done, dayLbl[i], skinClass));
  }

  // Weekly: last 6 weeks (current last)
  const wrapW=$('#weeklyMedals'); wrapW.innerHTML='';
  const curStart=startOfWeek(new Date());
  for(let i=5;i>=0;i--){
    const wkStart=addDays(curStart,-7*i); const key=weekKey(wkStart);
    const done=weeklyDone.includes(key);
    wrapW.appendChild(medalEl(done, 'W'+(6-i), 'm-silver'));
  }
}
paintTracker();

/* API to mark a weekly complete */
window.AO_markWeeklyComplete=function(dateLike){
  const key=weekKey(dateLike?new Date(dateLike):new Date());
  if(!weeklyDone.includes(key)){ weeklyDone.push(key); store.set(K.weeklyDone,weeklyDone); paintTracker(); }
};

/* Basic boot log */
console.log('[FAOA] boot check OK');
})();
</script>

</body>
</html>