<!DOCTYPE html>
<html lang="en-AU">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<title>Home — FAOA</title>

<style>
:root{
  --ink:#eef3ff; --ink-dim:#cfd3e1; --muted:rgba(238,243,255,.78);
  --bg:#000; --stroke:rgba(255,255,255,.18);
  --blue:#0A84FF; --green:#32d74b; --gold:#ffd700; --silver:#c0c7d1; --bronze:#b87333; --red:#ff3b30; --black:#111;
  --gap:12px; --r:14px; --maxw:1240px; --nav-h:68px; --btn-h:44px; --btn-bottom:14px;
}

/* RESET / BASE */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);
  font:16px -apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
  overscroll-behavior-y:contain; overscroll-behavior-x:none; overflow-x:hidden}
a{color:inherit;text-decoration:none}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

/* Background */
.bg{position:fixed;inset:0;z-index:-1;background:#000 url("./assets/home-bg.jpg") center/cover no-repeat}

/* ===== FIXED TOP BAR ===== */
.nav{
  position:fixed; top:0; left:0; right:0; height:var(--nav-h);
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:8px 12px; z-index:50;
  background:linear-gradient(180deg, rgba(0,0,0,.9), rgba(0,0,0,.55) 60%, rgba(0,0,0,.3));
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
}
.nav-left{display:flex; gap:8px; align-items:center; flex-wrap:nowrap}
.btn-tab{
  position:relative;
  display:inline-flex; align-items:center; justify-content:center;
  min-width:104px; height:44px; padding:0 14px;
  border-radius:12px; border:1px solid var(--stroke);
  background:rgba(0,0,0,.55); color:var(--ink); font-weight:900; cursor:pointer;
  transition:transform .06s ease, filter .15s ease; font-size:15px; white-space:nowrap;
}
.btn-tab:active{transform:translateY(1px)}
.btn-tab.is-active{background:var(--blue); border-color:transparent; color:#000}
/* Config affordances on tabs */
.config-on .btn-tab .tab-pin{display:flex}
.tab-pin{display:none; position:absolute; top:-6px; right:-6px; width:22px; height:22px;
  border-radius:8px; background:#111; border:1px solid var(--stroke); font-size:12px;
  font-weight:900; color:#fff; align-items:center; justify-content:center}

/* Portrait: compact tabs; Landscape normal */
@media (orientation:portrait){
  .btn-tab{ min-width:auto; padding:0 10px; font-size:14px }
}

/* Avatar pill (no photo; solid colour by role) */
.avatarTab{
  display:flex; flex-direction:column; align-items:flex-start; justify-content:center;
  padding:6px 12px; border-radius:12px; min-width:132px; height:44px;
  font-weight:900; line-height:1.1; text-align:left; cursor:pointer;
  border:1px solid var(--stroke); background:#222;
}
.avatarTab .name{font-size:15px; font-weight:900}
.avatarTab .lvl{font-size:12px; opacity:.95; text-transform:capitalize}

/* Content wrap (safe area for fixed header) */
.wrap{max-width:var(--maxw); margin:0 auto; padding:calc(var(--nav-h) + env(safe-area-inset-top) + 10px) 14px 140px}

/* ===== HERO ===== */
.hero{position:relative; overflow:hidden; background:#060708;
  border:1px solid var(--stroke); border-radius:16px; padding:16px; margin:12px 0}
.hero .title{margin:0 0 6px; font-weight:900; font-size:20px; display:flex; align-items:center; gap:8px}
.hero .meta{margin:0 0 6px; color:var(--ink-dim)}
.hero .desc{margin:8px 0 56px; color:var(--muted)}
.cta-left{position:absolute; left:16px; bottom:var(--btn-bottom); display:flex; gap:10px}
.btn{display:inline-flex; align-items:center; justify-content:center; min-width:130px; height:var(--btn-h); padding:0 16px; border-radius:12px; border:1px solid var(--stroke); font-weight:900; background:#0f1116; color:var(--ink); cursor:pointer}
.btn.blue{background:var(--blue); border-color:transparent; color:#000}
.btn.grey{background:#3a3a3a; color:#fff}
.badge{display:inline-flex; align-items:center; height:28px; padding:0 10px; border-radius:999px; border:1px solid var(--stroke); font-weight:900; font-size:12px}

/* Daily skin gloss (kept for look) */
#dailyHero[data-skin="bronze"]{ background:linear-gradient(135deg,#5e3515,#b86b2e 40%,#ffb067 70%,#5e3515 95%); color:#fff }
#dailyHero[data-skin="silver"]{ background:linear-gradient(135deg,#7c838a,#cfd6dd 35%,#f7f9fa 60%,#7c838a 90%); color:#111 }
#dailyHero[data-skin="gold"]{ background:linear-gradient(135deg,#9c7a00,#d4af37 35%,#ffe680 65%,#9c7a00 95%); color:#111 }
#dailyHero[data-skin="black"]{ background:linear-gradient(135deg,#000,#222 30%,#444 50%,#111 70%,#000 95%); color:#fff; border-color:rgba(255,255,255,.22) }
#dailyHero .level{ position:absolute; top:12px; right:16px; font-weight:800; font-size:18px }

/* ===== TRACKER (Daily only) ===== */
.tracker{cursor:pointer}
.tracker .cards{display:grid; grid-template-columns:1fr; gap:var(--gap)}
.tracker .card{border:1px solid var(--stroke); border-radius:12px; padding:12px; background:rgba(255,255,255,.03)}
.tracker .kpi{display:flex; align-items:center; gap:8px; color:var(--ink-dim); font-weight:700}
.medals{display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap; margin-top:10px}
.medal{width:30px; height:30px; border-radius:50%; border:2px solid rgba(255,255,255,.22); background:transparent}

/* PANELS */
[data-panel]{display:none}
[data-panel].panel-active{display:block}

/* ===== Admin inline controls on hero ===== */
.admin-ctrls{position:absolute; top:10px; right:10px; display:none; gap:8px; z-index:2}
.admin-on .admin-ctrls{display:flex}
.admin-ctrls .ctl{height:28px; padding:0 10px; border-radius:999px; border:1px solid var(--stroke); background:#141416; color:#fff; font-weight:800; font-size:12px; cursor:pointer}
.admin-ctrls .state-live{background:#0a0}
.admin-ctrls .state-off{background:#b00020}
.admin-ctrls .move{background:#1b1f2a; position:relative}

/* Move popover */
.move-menu{position:absolute; top:32px; right:0; background:#0f0f12; border:1px solid var(--stroke); border-radius:10px; padding:6px; display:none; z-index:3; min-width:210px}
.move-menu.open{display:block}
.move-menu button{display:block; width:100%; text-align:left; padding:8px 10px; border-radius:8px; border:1px solid var(--stroke); background:#141416; color:#fff; font-weight:800; font-size:12px; margin:4px 0; cursor:pointer}
.move-menu button:hover{filter:brightness(1.1)}

/* ===== Config pencil ===== */
.cfg-pin{display:none; position:absolute; top:10px; left:10px; width:24px; height:24px; border-radius:8px; background:#111; border:1px solid var(--stroke); font-size:14px; font-weight:900; color:#fff; align-items:center; justify-content:center; z-index:2}
.config-on .cfg-pin{display:flex}

/* ===== Avatar Drawer ===== */
#avatarSheet{position:fixed; inset:0; z-index:60; display:none; background:rgba(0,0,0,.45); -webkit-backdrop-filter:blur(4px); backdrop-filter:blur(4px)}
#avatarSheet.open{display:block}
#avatarSheet .panel{position:absolute; top:calc(var(--nav-h) + 6px); right:12px; width:320px; max-height:70vh; overflow:auto; background:#0f1116; border:1px solid var(--stroke); border-radius:14px; padding:12px}
.menu a{display:flex; align-items:center; justify-content:space-between; padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.08)}
.menu a:last-child{border-bottom:none}

/* ===== Subsheet (iframe) ===== */
#subSheet{position:fixed; inset:0; z-index:70; display:none; background:rgba(0,0,0,.55); -webkit-backdrop-filter:blur(6px); backdrop-filter:blur(6px)}
#subSheet.open{display:block}
#subSheet .inner{position:absolute; top:calc(var(--nav-h) + 6px); right:12px; width:min(820px,calc(100% - 24px)); height:min(78vh,calc(100% - (var(--nav-h) + 24px))); background:#0f1116; border:1px solid var(--stroke); border-radius:14px; padding:12px; display:flex; flex-direction:column}
.sheet-head{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:4px 4px 10px}
.sheet-head h2{margin:0; font-size:22px; font-weight:900}
.sheet-close{width:36px; height:36px; border-radius:10px; border:1px solid var(--stroke); background:#121212; color:#fff; font-weight:900; cursor:pointer}
#subFrame{flex:1 1 auto; width:100%; height:100%; border:none; border-radius:12px; background:#0b0c10; overflow:hidden}

/* ===== Admin footer / Working Drawer ===== */
#adminTab{position:fixed; left:0; right:0; bottom:0; height:42px; display:flex; align-items:center; justify-content:center; z-index:90}
#adminTab button{background:var(--red); color:#fff; border:0; border-top-left-radius:12px; border-top-right-radius:12px; padding:10px 16px; font-weight:900; cursor:pointer}
#adminDock{position:fixed; left:0; right:0; top:0; bottom:0; transform:translateY(100%); transition:transform .18s ease; z-index:89; background:#0e0b0b}
#adminDock.open{transform:translateY(0)}
#adminDock header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; font-weight:900; color:#fff; background:#1a0e0e; position:sticky; top:0; z-index:1}
#adminDock header .title{color:var(--blue)}
#adminDock header .closeBtn{background:var(--red); border:0; color:#fff; font-weight:900; padding:8px 12px; border-radius:10px; cursor:pointer}
#adminDock .space{position:absolute; top:52px; bottom:190px; left:0; right:0; overflow:auto; padding:12px}
#adminDock .bins{position:absolute; left:0; right:0; bottom:0; height:190px; padding:10px 12px; border-top:1px solid rgba(255,255,255,.14); background:#120c0c; overflow:auto}
.admin-group{border:1px solid rgba(255,255,255,.14); border-radius:12px; padding:12px; margin-bottom:14px}
.admin-group h3{margin:0 0 10px; font-size:15px}
.bin{border:1px dashed rgba(255,255,255,.18); border-radius:10px; margin:8px 0}
.bin > summary{cursor:pointer; padding:10px 12px; list-style:none; font-weight:900}
.bin > summary::-webkit-details-marker{display:none}
.bin .list{padding:8px 12px 12px}
.list .item{display:flex; align-items:center; justify-content:space-between; padding:10px 8px; border-radius:10px; background:#0d0d0f; margin:6px 0; border:1px solid var(--stroke)}
.list .name{font-size:14px}
.small{height:30px; padding:0 8px; border-radius:8px; border:1px solid var(--stroke); background:#131416; color:#fff; font-weight:800; font-size:12px; cursor:pointer}
.small.open{background:#0A84FF; color:#000}
.small.link{background:#222}

/* Swipe hint (optional, subtle) */
.swipe-hint{position:absolute; right:12px; top:12px; font-size:12px; opacity:.7}
</style>
</head>
<body>
<div class="bg" aria-hidden="true"></div>

<header class="nav" role="navigation" aria-label="Primary">
  <div class="nav-left" role="tablist" aria-label="Sections" id="tabsBar">
    <!-- Order is persisted; default below will be re-painted by JS if changed -->
    <button class="btn-tab is-active" data-tab="feed" aria-selected="true">Feed<span class="tab-pin" data-tab-pin="feed">✎</span></button>
    <button class="btn-tab" data-tab="challenges" aria-selected="false">Challenges<span class="tab-pin" data-tab-pin="challenges">✎</span></button>
    <button class="btn-tab" data-tab="courses" aria-selected="false">Courses<span class="tab-pin" data-tab-pin="courses">✎</span></button>
    <button class="btn-tab" data-tab="live" aria-selected="false">Live<span class="tab-pin" data-tab-pin="live">✎</span></button>
  </div>
  <div class="nav-right">
    <button id="avatarTab" class="avatarTab" aria-haspopup="dialog" aria-expanded="false">
      <span class="name" id="avatarName">User</span>
      <span class="lvl" id="avatarLvl">Admin</span>
    </button>
  </div>
</header>

<main class="wrap">
  <!-- ===== FEED ===== -->
  <section id="panel-feed" class="panel-active" data-panel="feed">
    <!-- five placeholders -->
    <article class="hero" data-hero-id="feed-1" data-hero-tab="feed">
      <button class="cfg-pin" data-cfg="feed-title-1">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" data-cfg-target="feed-title-1">Placeholder news-hero1</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="feed-2" data-hero-tab="feed">
      <button class="cfg-pin" data-cfg="feed-title-2">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" data-cfg-target="feed-title-2">Placeholder news-hero2</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="feed-3" data-hero-tab="feed">
      <button class="cfg-pin" data-cfg="feed-title-3">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" data-cfg-target="feed-title-3">Placeholder news-hero3</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="feed-4" data-hero-tab="feed">
      <button class="cfg-pin" data-cfg="feed-title-4">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" data-cfg-target="feed-title-4">Placeholder news-hero4</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="feed-5" data-hero-tab="feed">
      <button class="cfg-pin" data-cfg="feed-title-5">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" data-cfg-target="feed-title-5">Placeholder news-hero5</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
  </section>

  <!-- ===== CHALLENGES ===== -->
  <section id="panel-challenges" data-panel="challenges">
    <!-- Tracker -->
    <article class="hero tracker" id="trackerHero" data-hero-id="ch-tracker" data-hero-tab="challenges" aria-labelledby="trackerTitle">
      <button class="cfg-pin" data-cfg="tracker-title">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" id="trackerTitle" data-cfg-target="tracker-title">Challenge Tracker</h2>
      <p class="meta">Daily 7d</p>
      <div class="cards">
        <div class="card">
          <div class="kpi">Daily 7d</div>
          <div class="medals" id="dailyMedals"></div>
        </div>
      </div>
    </article>

    <!-- Daily -->
    <article class="hero" id="dailyHero" data-skin="bronze" data-hero-id="ch-daily" data-hero-tab="challenges" aria-labelledby="dailyTitle">
      <button class="cfg-pin" data-cfg="daily-title">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          Move
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>
        </button>
      </div>
      <h2 class="title" id="dailyTitle" data-cfg-target="daily-title">Daily Challenge</h2>
      <p class="meta" id="dailyMeta">Begins today</p>
      <p class="desc">A focused prompt matched to your level. Finish it to earn your streak.</p>
      <div class="cta-left">
        <button class="btn blue" id="btnDailyStart">Start</button>
        <button class="btn grey" id="btnDailyComplete">Complete</button>
      </div>
      <div class="level" id="dailyLevel">Beginner</div>
    </article>

    <!-- three more placeholders to make five total on this tab -->
    <article class="hero" data-hero-id="ch-2" data-hero-tab="challenges">
      <button class="cfg-pin" data-cfg="ch-title-2">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="ch-title-2">Placeholder challenge-hero2</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="ch-3" data-hero-tab="challenges">
      <button class="cfg-pin" data-cfg="ch-title-3">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="ch-title-3">Placeholder challenge-hero3</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="ch-4" data-hero-tab="challenges">
      <button class="cfg-pin" data-cfg="ch-title-4">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="ch-title-4">Placeholder challenge-hero4</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
  </section>

  <!-- ===== COURSES ===== -->
  <section id="panel-courses" data-panel="courses">
    <article class="hero" data-hero-id="co-1" data-hero-tab="courses">
      <button class="cfg-pin" data-cfg="cr-1">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="cr-1">Placeholder course-hero1</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="co-2" data-hero-tab="courses">
      <button class="cfg-pin" data-cfg="cr-2">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="cr-2">Placeholder course-hero2</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="co-3" data-hero-tab="courses">
      <button class="cfg-pin" data-cfg="cr-3">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="cr-3">Placeholder course-hero3</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="co-4" data-hero-tab="courses">
      <button class="cfg-pin" data-cfg="cr-4">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="cr-4">Placeholder course-hero4</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
    <article class="hero" data-hero-id="co-5" data-hero-tab="courses">
      <button class="cfg-pin" data-cfg="cr-5">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="cr-5">Placeholder course-hero5</h2>
      <p class="meta">Coming Soon</p><p class="desc">—</p>
    </article>
  </section>

  <!-- ===== LIVE ===== -->
  <section id="panel-live" data-panel="live">
    <article class="hero" data-hero-id="lv-1" data-hero-tab="live">
      <button class="cfg-pin" data-cfg="lv-1">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="lv-1">Placeholder live-hero1</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="lv-2" data-hero-tab="live">
      <button class="cfg-pin" data-cfg="lv-2">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="lv-2">Placeholder live-hero2</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="lv-3" data-hero-tab="live">
      <button class="cfg-pin" data-cfg="lv-3">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="lv-3">Placeholder live-hero3</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="lv-4" data-hero-tab="live">
      <button class="cfg-pin" data-cfg="lv-4">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="lv-4">Placeholder live-hero4</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
    <article class="hero" data-hero-id="lv-5" data-hero-tab="live">
      <button class="cfg-pin" data-cfg="lv-5">✎</button>
      <div class="admin-ctrls">
        <button class="ctl state-live" data-toggle-state>Live</button>
        <button class="ctl move" data-move>
          <div class="move-menu">
            <button data-move-to="dev">Move to Development Space</button>
            <button data-move-to="archive">Move to Archive</button>
            <button data-move-to="tpl">Move to Templates</button>
            <button data-move-to="page">Move to Page</button>
          </div>Move
        </button>
      </div>
      <h2 class="title" data-cfg-target="lv-5">Placeholder live-hero5</h2>
      <p class="meta">Coming Soon</p><p class="desc">Coming Soon</p>
    </article>
  </section>
</main>

<!-- ===== AVATAR DRAWER ===== -->
<div id="avatarSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel" role="document">
    <nav class="menu">
      <a href="avatar/profile.html" data-pop="Profile">Profile<span>›</span></a>
      <a href="avatar/settings.html" data-pop="Settings">Settings<span>›</span></a>
      <a href="avatar/mydata.html" data-pop="My Data">My Data<span>›</span></a>
      <a href="avatar/challengetracker.html" data-pop="Challenge Tracker">Challenge Tracker<span>›</span></a>
      <a href="avatar/statistics.html" data-pop="Statistics">Statistics<span>›</span></a>
      <a href="avatar/usersearch.html" data-pop="User Search">User Search<span>›</span></a>
      <a href="#" id="cfgToggle">Config Mode<span>⌁</span></a>
    </nav>
  </div>
</div>

<!-- ===== SUB SHEET ===== -->
<div id="subSheet" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="inner" role="document">
    <div class="sheet-head">
      <h2 id="sheetTitle">—</h2>
      <button class="sheet-close" id="sheetClose" aria-label="Close">×</button>
    </div>
    <iframe id="subFrame" title="Panel"></iframe>
  </div>
</div>

<!-- ===== ADMIN TAB & DOCK (Working Drawer) ===== -->
<div id="adminTab"><button id="toggleDockBtn">Working Drawer</button></div>
<div id="adminDock" aria-hidden="true">
  <header>
    <div class="title" id="dockTitle">Development Space — Feed</div>
    <div class="swipe-hint">‹ swipe ›</div>
    <button class="closeBtn" id="closeDockBtn">Close</button>
  </header>
  <div class="space" id="devSpace"></div>
  <div class="bins">
    <details class="bin" id="binArchive"><summary>Archived</summary><div class="list" id="listArchive"></div></details>
    <details class="bin" id="binTpl"><summary>Templates</summary><div class="list" id="listTpl"></div></details>
  </div>
</div>

<script>
(()=>{'use strict';
/* ===================== Utils / storage ===================== */
const $=s=>document.querySelector(s);
const $$=s=>Array.from(document.querySelectorAll(s));
const store={get:(k,f)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):f}catch{return f}},
             set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};
const K={ profile:'ao_profile', settings:'ao_settings', heroLinks:'ao_hero_links' };

/* Force Admin role during build; show admin UI */
document.body.classList.add('admin-on');
function currentRole(){ return 'admin'; }

/* Role skins (placeholders for future) */
const ROLE_SKINS={
  bronze:{pill:'var(--bronze)', text:'#111', daily:'bronze'},
  silver:{pill:'var(--silver)', text:'#0b0c10', daily:'silver'},
  gold:{pill:'var(--gold)', text:'#0b0c10', daily:'gold'},
  support:{pill:'#6a4cff', text:'#fff', daily:'black'},
  director:{pill:'#444', text:'#fff', daily:'black'},
  admin:{pill:'var(--blue)', text:'#0b0c10', daily:'black'}
};

function applyProfile(){
  const p=store.get(K.profile,{displayName:'User',skill:currentRole()});
  const role=(p.skill||currentRole()).toLowerCase();
  const skin=ROLE_SKINS[role]||ROLE_SKINS.silver;
  $('#avatarName').textContent=p.displayName||'User';
  $('#avatarLvl').textContent=role.charAt(0).toUpperCase()+role.slice(1);
  const pill=$('#avatarTab'); pill.style.background=skin.pill; pill.style.color=skin.text;
  const daily=document.getElementById('dailyHero'); if(daily){ daily.setAttribute('data-skin', skin.daily); }
}
applyProfile();

/* ===================== Tab order & labels ===================== */
const DEFAULT_TABS=['feed','challenges','courses','live'];
const DEFAULT_LABELS={feed:'Feed',challenges:'Challenges',courses:'Courses',live:'Live'};

function getSettings(){
  const def={ tabs:[...DEFAULT_TABS], tabLabels:{...DEFAULT_LABELS}, heroFlags:{} };
  const cur=store.get(K.settings,null);
  if(!cur){ store.set(K.settings,def); return def; }
  // merge carefully
  return {
    ...def,
    ...(cur||{}),
    tabs: Array.isArray(cur?.tabs)&&cur.tabs.length ? cur.tabs : [...DEFAULT_TABS],
    tabLabels: {...DEFAULT_LABELS, ...(cur?.tabLabels||{})},
    heroFlags: {...(cur?.heroFlags||{})}
  };
}
function saveSettings(s){ store.set(K.settings,s); }

/* Paint tabs according to order/labels */
function paintTabs(){
  const s=getSettings(); const bar=$('#tabsBar');
  bar.innerHTML='';
  s.tabs.forEach((name,i)=>{
    const btn=document.createElement('button');
    btn.className='btn-tab';
    btn.dataset.tab=name;
    btn.setAttribute('aria-selected','false');
    btn.textContent=s.tabLabels[name]||DEFAULT_LABELS[name]||name;
    // config pin on tabs for renaming
    const pin=document.createElement('span');
    pin.className='tab-pin'; pin.dataset.tabPin=name; pin.textContent='✎';
    btn.appendChild(pin);

    bar.appendChild(btn);
  });
  // rebind events
  $$('.btn-tab').forEach(b=>b.addEventListener('click',()=>showTab(b.dataset.tab)));
}
paintTabs();

/* ===================== Panels switching ===================== */
function showTab(name){
  // activate tab button
  $$('.btn-tab').forEach(b=>{
    const on=b.dataset.tab===name;
    b.classList.toggle('is-active',on);
    b.setAttribute('aria-selected',on?'true':'false');
  });
  // show panel
  $$('[data-panel]').forEach(p=>p.classList.toggle('panel-active', p.dataset.panel===name));
  // update dock title scope
  updateDockTitle(name);
  // refresh drawer content if open
  if($('#adminDock').classList.contains('open')) paintWorkingDrawer();
  window.scrollTo({top:0,behavior:'smooth'});
}
showTab(getSettings().tabs[0]||'feed');

/* ===================== Avatar Drawer & Subsheet ===================== */
const avatarBtn=$('#avatarTab'), avatarSheet=$('#avatarSheet'), adminTab=$('#adminTab');
function openDrawer(){ avatarSheet.classList.add('open'); avatarSheet.setAttribute('aria-hidden','false'); avatarBtn.setAttribute('aria-expanded','true'); adminTab.style.display='none'; }
function closeDrawer(){ avatarSheet.classList.remove('open'); avatarSheet.setAttribute('aria-hidden','true'); avatarBtn.setAttribute('aria-expanded','false'); adminTab.style.display='flex'; }
avatarBtn.addEventListener('click', openDrawer);
avatarSheet.addEventListener('click', e=>{ if(e.target===avatarSheet) closeDrawer(); });

const subSheet=$('#subSheet'), subFrame=$('#subFrame'), sheetTitle=$('#sheetTitle');
function injectNoHorizontalScroll(){
  try{
    const d=subFrame.contentDocument||subFrame.contentWindow.document;
    const st=d.createElement('style'); st.textContent='html,body{overflow-x:hidden!important}';
    d.head.appendChild(st);
  }catch{}
}
function openSubSheet(title,url){
  sheetTitle.textContent=title;
  subFrame.src=url+(url.includes('?')?'&':'?')+'v='+Date.now();
  subFrame.addEventListener('load', injectNoHorizontalScroll, {once:true});
  subSheet.classList.add('open'); subSheet.setAttribute('aria-hidden','false');
}
function closeSubSheet(){
  subSheet.classList.remove('open'); subSheet.setAttribute('aria-hidden','true');
  subFrame.src='about:blank';
}
$('#sheetClose').addEventListener('click', closeSubSheet);
subSheet.addEventListener('click', e=>{ if(e.target===subSheet) closeSubSheet(); });
$$('#avatarSheet [data-pop]').forEach(a=>{
  a.addEventListener('click',e=>{
    e.preventDefault(); closeDrawer(); openSubSheet(a.dataset.pop, a.getAttribute('href'));
  });
});
$('#cfgToggle').addEventListener('click', (e)=>{
  e.preventDefault(); document.body.classList.toggle('config-on'); closeDrawer();
});

/* ===================== Hero state (Live/Offline) + Move ===================== */

/*
 heroFlags[id] = {
   state:'live'|'off',
   place:'page'|'dev'|'archive'|'tpl',
   tab:'feed'|'challenges'|'courses'|'live'
 }
*/
function heroDefaultFor(el){
  return {state:'live', place:'page', tab: el?.dataset?.heroTab || findHostTabFor(el) || 'feed'};
}
function findHostTabFor(el){
  const host=el?.closest('[data-panel]'); return host?host.dataset.panel:'feed';
}
function getHeroFlags(){ return getSettings().heroFlags; }
function setHeroFlag(id, patch){
  const s=getSettings();
  const current=s.heroFlags[id] || heroDefaultFor(document.querySelector(`[data-hero-id="${id}"]`));
  s.heroFlags[id] = {...current, ...patch};
  saveSettings(s);
}

/* Apply visibility on page per flags; offline visible only to admin */
function applyHeroVisibility(){
  const flags=getHeroFlags();
  $$('[data-hero-id]').forEach(el=>{
    const id=el.dataset.heroId;
    const f=flags[id] || heroDefaultFor(el);
    // Keep hero in DOM if place==='page', else hide from page
    const onPage = f.place==='page';
    el.style.display = onPage ? '' : 'none';

    // Paint state button
    const btn=el.querySelector('[data-toggle-state]');
    if(btn){
      btn.textContent = (f.state==='live'?'Live':'Offline');
      btn.classList.toggle('state-live', f.state==='live');
      btn.classList.toggle('state-off', f.state!=='live');
    }

    // If hero is on page but offline and viewer is not admin, hide — we are admin now, but keep rule
    const isAdmin = true; // forced during build
    if(onPage && f.state==='off' && !isAdmin){
      el.style.display='none';
    }
  });
}
applyHeroVisibility();

/* Wire clicks for toggles + move */
document.body.addEventListener('click',(e)=>{
  const hero=e.target.closest('[data-hero-id]');
  // Toggle Live/Offline
  if(hero && e.target.matches('[data-toggle-state]')){
    const id=hero.dataset.heroId;
    const flags=getHeroFlags(); const cur=flags[id] || heroDefaultFor(hero);
    const next=(cur.state==='live'?'off':'live');
    const ok=confirm(`Set this hero ${next==='live'?'LIVE (visible)':'OFFLINE (hidden to non-admin)'}?`);
    if(!ok) return;
    setHeroFlag(id,{state:next});
    applyHeroVisibility(); paintWorkingDrawer();
  }
  // Open/close move menu
  if(hero && (e.target.matches('[data-move]') || e.target.closest('[data-move]'))){
    const menu=hero.querySelector('.move-menu'); if(menu) menu.classList.toggle('open');
  }
  // Move destination
  if(hero && e.target.matches('.move-menu [data-move-to]')){
    const id=hero.dataset.heroId; const dest=e.target.getAttribute('data-move-to');
    moveHero(id, dest);
    const menu=hero.querySelector('.move-menu'); if(menu) menu.classList.remove('open');
  }
});
document.addEventListener('click', (e)=>{ if(!e.target.closest('.move')) $$('.move-menu.open').forEach(m=>m.classList.remove('open')); });
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape') $$('.move-menu.open').forEach(m=>m.classList.remove('open')); });

function moveHero(id, place){
  const s=getSettings(); const cur=s.heroFlags[id] || heroDefaultFor(document.querySelector(`[data-hero-id="${id}"]`));
  if(place==='dev'){
    const curTab=cur.tab;
    const countDev = Object.entries(s.heroFlags).filter(([hid,f])=> (f?.place==='dev' && f?.tab===curTab)).length;
    if(cur.place!=='dev' && countDev>=3){ alert('Development Space can hold only 3 cards for this tab.'); return; }
  }
  s.heroFlags[id]={...cur, place};
  saveSettings(s);
  applyHeroVisibility(); paintWorkingDrawer();
}

/* ===================== Working Drawer (tab-scoped) ===================== */
const toggleDockBtn=$('#toggleDockBtn'), adminDock=$('#adminDock'), devSpace=$('#devSpace');
const closeDockBtn=$('#closeDockBtn');
function openDock(){ adminDock.classList.add('open'); toggleDockBtn.textContent='Close Working Drawer'; }
function closeDock(){ adminDock.classList.remove('open'); toggleDockBtn.textContent='Working Drawer'; }
toggleDockBtn.addEventListener('click', ()=> adminDock.classList.contains('open') ? closeDock() : openDock());
closeDockBtn.addEventListener('click', closeDock);
function updateDockTitle(activeTab){
  const labels=getSettings().tabLabels||DEFAULT_LABELS;
  $('#dockTitle').textContent = `Development Space — ${labels[activeTab]||activeTab}`;
}
updateDockTitle(getSettings().tabs[0]||'feed');

/* Links store */
function getLinks(){ return store.get(K.heroLinks,{}); }
function setLink(id,url){ const L=getLinks(); L[id]=url; store.set(K.heroLinks,L); }

/* Paint drawer content for current tab */
function currentTabName(){
  const active=document.querySelector('.btn-tab.is-active'); return active?active.dataset.tab:'feed';
}
function paintWorkingDrawer(){
  const tab=currentTabName(); const flags=getHeroFlags(); const links=getLinks();
  devSpace.innerHTML='';
  const LA=$('#listArchive'); const LT=$('#listTpl'); LA.innerHTML=''; LT.innerHTML='';

  // Dev
  Object.entries(flags).forEach(([id,f])=>{
    if(f.tab!==tab) return;
    const title = document.querySelector(`[data-hero-id="${id}"] .title`)?.textContent?.trim() || id;
    if(f.place==='dev'){
      const card=document.createElement('article'); card.className='hero';
      card.innerHTML=`<h2 class="title">${title}</h2>
        <div class="admin-ctrls" style="display:flex">
          <button class="ctl ${f.state==='live'?'state-live':'state-off'}" data-dock-id="${id}" data-dock-act="toggle">${f.state==='live'?'Live':'Offline'}</button>
          <button class="ctl move" data-dock-id="${id}" data-dock-move>Move
            <div class="move-menu">
              <button data-dock-id="${id}" data-dock-to="page">Move to Page</button>
              <button data-dock-id="${id}" data-dock-to="archive">Move to Archive</button>
              <button data-dock-id="${id}" data-dock-to="tpl">Move to Templates</button>
            </div>
          </button>
        </div>
        <p class="meta">Dev preview only</p>`;
      devSpace.appendChild(card);
    }
  });

  // Bins
  const renderRow=(host,id,f)=>{
    const title = document.querySelector(`[data-hero-id="${id}"] .title`)?.textContent?.trim() || id;
    const link=links[id]||'';
    const row=document.createElement('div'); row.className='item';
    row.innerHTML=`<div class="name">${title}</div>
      <div>
        <button class="small link" data-link-id="${id}">${link?'Change Link':'Set Link'}</button>
        <button class="small open" data-open-id="${id}">Open</button>
        <button class="small" data-move-id="${id}" data-place="page">To Page</button>
        <button class="small" data-move-id="${id}" data-place="${f.place==='archive'?'tpl':'archive'}">To ${f.place==='archive'?'Templates':'Archive'}</button>
      </div>`;
    host.appendChild(row);
  };
  Object.entries(flags).forEach(([id,f])=>{
    if(f.tab!==tab) return;
    if(f.place==='archive') renderRow(LA,id,f);
    if(f.place==='tpl') renderRow(LT,id,f);
  });
}
paintWorkingDrawer();

/* Drawer interactions (buttons inside) */
$('#adminDock').addEventListener('click',(e)=>{
  // toggle live/off
  if(e.target.matches('[data-dock-act="toggle"]')){
    const id=e.target.dataset.dockId; const flags=getHeroFlags(); const cur=flags[id];
    setHeroFlag(id,{state:(cur.state==='live'?'off':'live')});
    applyHeroVisibility(); paintWorkingDrawer(); return;
  }
  // open/close move menu
  if(e.target.matches('[data-dock-move], [data-dock-move] *')){
    const btn=e.target.closest('[data-dock-move]'); const menu=btn.querySelector('.move-menu'); menu.classList.toggle('open'); return;
  }
  // move actions inside move-menu
  if(e.target.matches('[data-dock-to]')){
    moveHero(e.target.dataset.dockId, e.target.dataset.dockTo); return;
  }
  // set/change link
  if(e.target.matches('[data-link-id]')){
    const id=e.target.dataset.linkId; const cur=getLinks()[id]||'';
    const url=prompt('Enter linked HTML/URL', cur||'');
    if(url!=null && url.trim()!==''){ setLink(id,url.trim()); paintWorkingDrawer(); }
    return;
  }
  // open link
  if(e.target.matches('[data-open-id]')){
    const id=e.target.dataset.openId; const url=getLinks()[id];
    if(!url){ alert('No link set yet. Use “Set Link”.'); return; }
    openSubSheet('Hero', url); return;
  }
  // move from bin row
  if(e.target.matches('[data-move-id]')){
    moveHero(e.target.dataset.moveId, e.target.dataset.place); return;
  }
});

/* Swipe across drawers: left/right to switch active tab while dock open */
(function enableDrawerSwipe(){
  let startX=0, startY=0, swiping=false;
  const THRESH=40, ANGLE=25; // px, degrees
  adminDock.addEventListener('touchstart',(e)=>{
    if(!adminDock.classList.contains('open')) return;
    const t=e.touches[0]; startX=t.clientX; startY=t.clientY; swiping=true;
  },{passive:true});
  adminDock.addEventListener('touchmove',(e)=>{
    if(!swiping) return;
    const t=e.touches[0]; const dx=t.clientX-startX; const dy=t.clientY-startY;
    const adx=Math.abs(dx), ady=Math.abs(dy);
    if(adx<THRESH || adx<ady*Math.tan(ANGLE*Math.PI/180)) return; // ignore if mostly vertical or short
    // Determine direction
    const s=getSettings(); const order=s.tabs; const cur=currentTabName(); const idx=order.indexOf(cur);
    if(dx>0 && idx>0){ // swipe right -> previous tab
      showTab(order[idx-1]); paintWorkingDrawer();
    }else if(dx<0 && idx<order.length-1){ // swipe left -> next tab
      showTab(order[idx+1]); paintWorkingDrawer();
    }
    swiping=false;
  },{passive:true});
  adminDock.addEventListener('touchend',()=>{ swiping=false; },{passive:true});
})();

/* Hide admin tab while avatar drawer open (already handled in open/close) */

/* ===================== Config Mode: edit titles & tab labels / reorder ===================== */
document.body.addEventListener('click', (e)=>{
  const pin=e.target.closest('.cfg-pin'); if(!pin) return;
  const id=pin.dataset.cfg; const tgt=document.querySelector(`[data-cfg-target="${id}"]`);
  if(!tgt) return;
  const cur=tgt.textContent.trim();
  const next=prompt('Edit title', cur);
  if(next!=null){ tgt.textContent=next; }
});

/* Edit tab labels via pin */
document.addEventListener('click',(e)=>{
  const pin=e.target.closest('[data-tab-pin]'); if(!pin) return;
  if(!document.body.classList.contains('config-on')) return;
  const tab=pin.dataset.tabPin; const s=getSettings();
  const cur=s.tabLabels[tab]||DEFAULT_LABELS[tab]||tab;
  const next=prompt('Rename tab', cur);
  if(next!=null && next.trim()!==''){
    s.tabLabels[tab]=next.trim(); saveSettings(s); paintTabs();
    // keep current tab active
    const active=currentTabName(); showTab(active);
  }
});

/* Reorder tabs: press-and-hold on a tab label to nudge left/right prompts */
let holdTimer=null;
document.addEventListener('mousedown',(e)=>{
  const btn=e.target.closest('.btn-tab'); if(!btn) return;
  if(!document.body.classList.contains('config-on')) return;
  holdTimer=setTimeout(()=>{
    const s=getSettings(); const order=s.tabs; const name=btn.dataset.tab;
    const action=prompt('Move tab:\nType "<" to move left, ">" to move right', '');
    if(action==='<'||action==='>'){
      const idx=order.indexOf(name);
      if(action==='<' && idx>0){ [order[idx-1],order[idx]]=[order[idx],order[idx-1]]; }
      if(action==='>' && idx<order.length-1){ [order[idx+1],order[idx]]=[order[idx],order[idx+1]]; }
      s.tabs=order; saveSettings(s); paintTabs(); showTab(name); // keep same active
      updateDockTitle(name);
    }
  },600);
});
document.addEventListener('mouseup',()=>{ if(holdTimer){clearTimeout(holdTimer); holdTimer=null;} });
document.addEventListener('mouseleave',()=>{ if(holdTimer){clearTimeout(holdTimer); holdTimer=null;} });

/* ===================== Tracker placeholder & clicks ===================== */
(function paintEmptyMedals(){
  const dm=$('#dailyMedals'); if(!dm) return;
  dm.innerHTML=''; for(let i=0;i<7;i++){ const m=document.createElement('div'); m.className='medal'; dm.appendChild(m); }
})();
$('#trackerHero').addEventListener('click',()=>openSubSheet('Challenge Tracker','avatar/challengetracker.html'));

/* ===================== Boot: attach hero tab metadata (safety) ===================== */
$$('[data-hero-id]').forEach(el=>{
  if(!el.dataset.heroTab) el.dataset.heroTab = findHostTabFor(el);
  const id=el.dataset.heroId; const flags=getHeroFlags();
  if(!flags[id]) setHeroFlag(id,{tab:el.dataset.heroTab});
});
applyHeroVisibility(); paintWorkingDrawer();

/* ===================== QoL: ensure admin footer is pinned bottom on all tabs ===================== */
/* Already fixed by position:fixed; no-op here, but we relabel title when tab changes */

/* ===================== End boot ===================== */
console.log('[FAOA] home loaded — admin framework with Live/Offline + Working Drawer + swipe drawers ready.');
})();
</script>
</body>
</html>